nohup: ignoring input
3
/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Making experiment directory /home/wxt/.cache/huggingface/hub/llama2_7b_sft_halos
WARNING: eval_every must be divisible by batch_size
Setting eval_every to 896
no FSDP port specified; using open port for FSDP: 32787
seed: 1
exp_name: llama2_7b_sft_halos
datasets:
- hh
mode: train
debug: false
use_fsdp: true
fsdp_port: 32787
wandb:
  enabled: true
  entity: null
  project: archangel
cache_dir: /home/wxt/.cache/huggingface/hub
local_run_dir: /home/wxt/.cache/huggingface/hub/llama2_7b_sft_halos
do_first_eval: true
minimum_log_interval_secs: 1.0
intermediate_checkpoints: false
trainer: SFTTrainer
lr: 1.0e-06
n_epochs: 1
n_examples: null
optimizer: RMSprop
warmup_steps: 150
eval_every: 896
n_samples: 128
samples_dir: samples/
n_eval_examples: 512
saved_policy: /home/wxt/.cache/huggingface/hub/llama2_7b_sft_halos/LATEST/policy.pt
top_p: 0.95
human_prefix: '

  <|user|>

  '
assistant_prefix: '

  <|assistant|>

  '
human_suffix: ''
assistant_suffix: ''
frac_unique_desirable: 1.0
frac_unique_undesirable: 1.0
model:
  name_or_path: daryl149/llama-2-7b-hf
  tokenizer_name_or_path: null
  load_from: null
  block_name: LlamaDecoderLayer
  policy_dtype: bfloat16
  fsdp_policy_mp: null
  reference_dtype: bfloat16
  max_grad_norm: 10.0
  v_head_max_grad_norm: 0.1
  max_length: 1024
  max_prompt_length: 512
  activation_checkpointing: true
  batch_size: 128
  gradient_accumulation_steps: 1
  eval_batch_size: 16
  use_flash_attention: false
loss:
  name: sft
  trainer: SFTTrainer
  dataloader: SFTDataLoader
  use_reference_model: false

================================================================================
Writing to design-agent-09:/home/wxt/.cache/huggingface/hub/llama2_7b_sft_halos
================================================================================
building policy
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.61s/it]
Loading tokenizer daryl149/llama-2-7b-hf
0 special tokens added
Loading HH dataset (train split) from Huggingface...
Processing HH:   0%|          | 0/160800 [00:00<?, ?it/s]Processing HH:   1%|          | 1480/160800 [00:00<00:10, 14797.97it/s]Processing HH:   2%|▏         | 2960/160800 [00:00<00:10, 14757.47it/s]Processing HH:   3%|▎         | 4488/160800 [00:00<00:10, 14994.95it/s]Processing HH:   4%|▎         | 5988/160800 [00:00<00:10, 14824.43it/s]Processing HH:   5%|▍         | 7471/160800 [00:00<00:10, 14477.10it/s]Processing HH:   6%|▌         | 8929/160800 [00:00<00:10, 14509.71it/s]Processing HH:   6%|▋         | 10395/160800 [00:00<00:10, 14550.87it/s]Processing HH:   7%|▋         | 11862/160800 [00:00<00:10, 14586.95it/s]Processing HH:   8%|▊         | 13322/160800 [00:00<00:10, 14262.42it/s]Processing HH:   9%|▉         | 14750/160800 [00:01<00:10, 14199.89it/s]Processing HH:  10%|█         | 16172/160800 [00:01<00:13, 10580.37it/s]Processing HH:  11%|█         | 17665/160800 [00:01<00:12, 11634.47it/s]Processing HH:  12%|█▏        | 19087/160800 [00:01<00:11, 12298.16it/s]Processing HH:  13%|█▎        | 20466/160800 [00:01<00:11, 12698.18it/s]Processing HH:  14%|█▎        | 21924/160800 [00:01<00:10, 13218.03it/s]Processing HH:  15%|█▍        | 23362/160800 [00:01<00:10, 13546.79it/s]Processing HH:  15%|█▌        | 24805/160800 [00:01<00:09, 13799.58it/s]Processing HH:  16%|█▋        | 26237/160800 [00:01<00:09, 13948.62it/s]Processing HH:  17%|█▋        | 27698/160800 [00:02<00:09, 14142.48it/s]Processing HH:  18%|█▊        | 29156/160800 [00:02<00:09, 14269.01it/s]Processing HH:  19%|█▉        | 30622/160800 [00:02<00:09, 14383.04it/s]Processing HH:  20%|█▉        | 32131/160800 [00:02<00:08, 14591.03it/s]Processing HH:  21%|██        | 33621/160800 [00:02<00:11, 10766.24it/s]Processing HH:  22%|██▏       | 35103/160800 [00:02<00:10, 11730.71it/s]Processing HH:  23%|██▎       | 36572/160800 [00:02<00:09, 12481.19it/s]Processing HH:  24%|██▎       | 38048/160800 [00:02<00:09, 13086.84it/s]Processing HH:  25%|██▍       | 39539/160800 [00:02<00:08, 13585.59it/s]Processing HH:  26%|██▌       | 41011/160800 [00:03<00:08, 13898.12it/s]Processing HH:  26%|██▋       | 42446/160800 [00:03<00:08, 13976.99it/s]Processing HH:  27%|██▋       | 43876/160800 [00:03<00:08, 13953.39it/s]Processing HH:  28%|██▊       | 45294/160800 [00:03<00:08, 13912.30it/s]Processing HH:  29%|██▉       | 46701/160800 [00:03<00:08, 13633.20it/s]Processing HH:  30%|██▉       | 48076/160800 [00:03<00:08, 13568.87it/s]Processing HH:  31%|███       | 49441/160800 [00:03<00:08, 13529.95it/s]Processing HH:  32%|███▏      | 50800/160800 [00:03<00:08, 13459.90it/s]Processing HH:  32%|███▏      | 52165/160800 [00:03<00:08, 13514.90it/s]Processing HH:  33%|███▎      | 53527/160800 [00:03<00:07, 13544.73it/s]Processing HH:  34%|███▍      | 54904/160800 [00:04<00:07, 13610.39it/s]Processing HH:  35%|███▌      | 56292/160800 [00:04<00:07, 13689.03it/s]Processing HH:  36%|███▌      | 57662/160800 [00:04<00:11, 8671.72it/s] Processing HH:  37%|███▋      | 59001/160800 [00:04<00:10, 9673.43it/s]Processing HH:  38%|███▊      | 60362/160800 [00:04<00:09, 10589.21it/s]Processing HH:  38%|███▊      | 61734/160800 [00:04<00:08, 11370.60it/s]Processing HH:  39%|███▉      | 63138/160800 [00:04<00:08, 12071.96it/s]Processing HH:  40%|████      | 64524/160800 [00:04<00:07, 12556.92it/s]Processing HH:  41%|████      | 65931/160800 [00:05<00:07, 12978.52it/s]Processing HH:  42%|████▏     | 67332/160800 [00:05<00:07, 13271.40it/s]Processing HH:  43%|████▎     | 68731/160800 [00:05<00:06, 13478.44it/s]Processing HH:  44%|████▎     | 70116/160800 [00:05<00:06, 13581.51it/s]Processing HH:  44%|████▍     | 71496/160800 [00:05<00:06, 13532.72it/s]Processing HH:  45%|████▌     | 72872/160800 [00:05<00:06, 13599.09it/s]Processing HH:  46%|████▌     | 74268/160800 [00:05<00:06, 13702.44it/s]Processing HH:  47%|████▋     | 75667/160800 [00:05<00:06, 13785.40it/s]Processing HH:  48%|████▊     | 77066/160800 [00:05<00:06, 13846.19it/s]Processing HH:  49%|████▉     | 78455/160800 [00:05<00:05, 13823.93it/s]Processing HH:  50%|████▉     | 79862/160800 [00:06<00:05, 13896.29it/s]Processing HH:  51%|█████     | 81259/160800 [00:06<00:05, 13916.87it/s]Processing HH:  51%|█████▏    | 82694/160800 [00:06<00:05, 14046.15it/s]Processing HH:  52%|█████▏    | 84103/160800 [00:06<00:05, 14056.77it/s]Processing HH:  53%|█████▎    | 85510/160800 [00:06<00:05, 13863.45it/s]Processing HH:  54%|█████▍    | 86898/160800 [00:06<00:08, 8846.99it/s] Processing HH:  55%|█████▍    | 88013/160800 [00:06<00:08, 8709.53it/s]Processing HH:  55%|█████▌    | 89043/160800 [00:07<00:08, 8514.07it/s]Processing HH:  56%|█████▌    | 90004/160800 [00:07<00:08, 8514.42it/s]Processing HH:  57%|█████▋    | 90932/160800 [00:07<00:08, 8390.58it/s]Processing HH:  57%|█████▋    | 91823/160800 [00:07<00:08, 8422.82it/s]Processing HH:  58%|█████▊    | 92703/160800 [00:07<00:08, 8405.16it/s]Processing HH:  58%|█████▊    | 93570/160800 [00:07<00:08, 8288.49it/s]Processing HH:  59%|█████▊    | 94418/160800 [00:07<00:07, 8338.62it/s]Processing HH:  59%|█████▉    | 95265/160800 [00:07<00:07, 8341.61it/s]Processing HH:  60%|█████▉    | 96108/160800 [00:07<00:07, 8339.77it/s]Processing HH:  60%|██████    | 96958/160800 [00:07<00:07, 8384.43it/s]Processing HH:  61%|██████    | 97828/160800 [00:08<00:07, 8474.27it/s]Processing HH:  61%|██████▏   | 98679/160800 [00:08<00:07, 8284.33it/s]Processing HH:  62%|██████▏   | 99511/160800 [00:08<00:07, 8263.05it/s]Processing HH:  62%|██████▏   | 100340/160800 [00:08<00:07, 8227.30it/s]Processing HH:  63%|██████▎   | 101165/160800 [00:08<00:07, 8144.63it/s]Processing HH:  63%|██████▎   | 101981/160800 [00:08<00:07, 7887.39it/s]Processing HH:  64%|██████▍   | 102772/160800 [00:08<00:07, 7793.72it/s]Processing HH:  64%|██████▍   | 103625/160800 [00:08<00:07, 8002.12it/s]Processing HH:  65%|██████▍   | 104476/160800 [00:08<00:06, 8150.14it/s]Processing HH:  65%|██████▌   | 105322/160800 [00:09<00:06, 8241.22it/s]Processing HH:  66%|██████▌   | 106188/160800 [00:09<00:06, 8362.91it/s]Processing HH:  67%|██████▋   | 107026/160800 [00:09<00:06, 8350.35it/s]Processing HH:  67%|██████▋   | 107862/160800 [00:09<00:06, 8327.45it/s]Processing HH:  68%|██████▊   | 108882/160800 [00:09<00:05, 8883.51it/s]Processing HH:  68%|██████▊   | 110051/160800 [00:09<00:05, 9719.85it/s]Processing HH:  69%|██████▉   | 111237/160800 [00:09<00:04, 10356.98it/s]Processing HH:  70%|██████▉   | 112416/160800 [00:09<00:04, 10783.74it/s]Processing HH:  71%|███████   | 113629/160800 [00:09<00:04, 11185.60it/s]Processing HH:  71%|███████▏  | 114882/160800 [00:09<00:03, 11587.93it/s]Processing HH:  72%|███████▏  | 116113/160800 [00:10<00:03, 11801.85it/s]Processing HH:  73%|███████▎  | 117339/160800 [00:10<00:03, 11937.21it/s]Processing HH:  74%|███████▎  | 118564/160800 [00:10<00:03, 12027.43it/s]Processing HH:  75%|███████▍  | 119808/160800 [00:10<00:03, 12150.07it/s]Processing HH:  75%|███████▌  | 121059/160800 [00:10<00:03, 12257.85it/s]Processing HH:  76%|███████▌  | 122285/160800 [00:10<00:03, 12116.31it/s]Processing HH:  77%|███████▋  | 123498/160800 [00:10<00:05, 6799.40it/s] Processing HH:  78%|███████▊  | 124742/160800 [00:10<00:04, 7884.49it/s]Processing HH:  78%|███████▊  | 125969/160800 [00:11<00:03, 8830.24it/s]Processing HH:  79%|███████▉  | 127197/160800 [00:11<00:03, 9641.44it/s]Processing HH:  80%|███████▉  | 128412/160800 [00:11<00:03, 10271.64it/s]Processing HH:  81%|████████  | 129660/160800 [00:11<00:02, 10855.08it/s]Processing HH:  81%|████████▏ | 130846/160800 [00:11<00:02, 11073.08it/s]Processing HH:  82%|████████▏ | 132064/160800 [00:11<00:02, 11382.56it/s]Processing HH:  83%|████████▎ | 133255/160800 [00:11<00:02, 11514.75it/s]Processing HH:  84%|████████▎ | 134469/160800 [00:11<00:02, 11693.53it/s]Processing HH:  84%|████████▍ | 135701/160800 [00:11<00:02, 11874.02it/s]Processing HH:  85%|████████▌ | 136952/160800 [00:11<00:01, 12058.61it/s]Processing HH:  86%|████████▌ | 138188/160800 [00:12<00:01, 12147.77it/s]Processing HH:  87%|████████▋ | 139413/160800 [00:12<00:01, 12134.87it/s]Processing HH:  87%|████████▋ | 140640/160800 [00:12<00:01, 12173.93it/s]Processing HH:  88%|████████▊ | 141863/160800 [00:12<00:01, 12144.68it/s]Processing HH:  89%|████████▉ | 143081/160800 [00:12<00:01, 12026.39it/s]Processing HH:  90%|████████▉ | 144296/160800 [00:12<00:01, 12061.61it/s]Processing HH:  91%|█████████ | 145536/160800 [00:12<00:01, 12161.35it/s]Processing HH:  91%|█████████▏| 146754/160800 [00:12<00:01, 11983.48it/s]Processing HH:  92%|█████████▏| 147969/160800 [00:12<00:01, 12028.86it/s]Processing HH:  93%|█████████▎| 149173/160800 [00:12<00:00, 12027.69it/s]Processing HH:  94%|█████████▎| 150401/160800 [00:13<00:00, 12102.72it/s]Processing HH:  94%|█████████▍| 151619/160800 [00:13<00:00, 12122.18it/s]Processing HH:  95%|█████████▌| 152855/160800 [00:13<00:00, 12192.18it/s]Processing HH:  96%|█████████▌| 154075/160800 [00:13<00:00, 12133.42it/s]Processing HH:  97%|█████████▋| 155289/160800 [00:13<00:00, 12048.95it/s]Processing HH:  97%|█████████▋| 156523/160800 [00:13<00:00, 12134.17it/s]Processing HH:  98%|█████████▊| 157737/160800 [00:13<00:00, 12130.26it/s]Processing HH:  99%|█████████▉| 158971/160800 [00:13<00:00, 12190.30it/s]Processing HH: 100%|█████████▉| 160209/160800 [00:13<00:00, 12246.33it/s]Processing HH: 100%|██████████| 160800/160800 [00:13<00:00, 11525.14it/s]
Loading HH dataset (test split) from Huggingface...
Processing HH:   0%|          | 0/8552 [00:00<?, ?it/s]Processing HH:  17%|█▋        | 1440/8552 [00:00<00:00, 14394.56it/s]Processing HH:  34%|███▎      | 2880/8552 [00:00<00:00, 14209.75it/s]Processing HH:  50%|█████     | 4302/8552 [00:00<00:00, 13756.48it/s]Processing HH:  66%|██████▋   | 5680/8552 [00:00<00:00, 11539.98it/s]Processing HH:  80%|████████  | 6876/8552 [00:00<00:00, 5136.20it/s] Processing HH:  95%|█████████▍| 8106/8552 [00:01<00:00, 6322.28it/s]Processing HH: 100%|██████████| 8552/8552 [00:01<00:00, 7780.72it/s]
starting 3 processes for FSDP training
setting RLIMIT_NOFILE soft limit to 1048576 from 1024
3
0 initializing distributed
Creating trainer on process 0 with world size 3
Finished generating 512 examples on test split
Loaded 32 eval batches of size 16
Sharding models...
Attempting to enable activation checkpointing...
Applying activation checkpointing wrapper to policy...
FSDP activation checkpointing enabled!
Loaded model on rank 0
Using RMSprop optimizer with learning rate 1e-06
Running evaluation after 0 train examples
Computing eval metrics:   0%|          | 0/32 [00:00<?, ?it/s]/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
Computing eval metrics:   3%|▎         | 1/32 [00:01<00:35,  1.14s/it]Computing eval metrics:   6%|▋         | 2/32 [00:01<00:27,  1.11it/s]Computing eval metrics:   9%|▉         | 3/32 [00:02<00:22,  1.27it/s]Computing eval metrics:  12%|█▎        | 4/32 [00:03<00:19,  1.43it/s]Computing eval metrics:  16%|█▌        | 5/32 [00:03<00:18,  1.45it/s]Computing eval metrics:  19%|█▉        | 6/32 [00:04<00:16,  1.55it/s]Computing eval metrics:  22%|██▏       | 7/32 [00:04<00:15,  1.62it/s]Computing eval metrics:  25%|██▌       | 8/32 [00:05<00:14,  1.67it/s]Computing eval metrics:  28%|██▊       | 9/32 [00:06<00:13,  1.70it/s]Computing eval metrics:  31%|███▏      | 10/32 [00:06<00:13,  1.60it/s]Computing eval metrics:  34%|███▍      | 11/32 [00:07<00:12,  1.64it/s]Computing eval metrics:  38%|███▊      | 12/32 [00:07<00:11,  1.67it/s]Computing eval metrics:  41%|████      | 13/32 [00:08<00:11,  1.68it/s]Computing eval metrics:  44%|████▍     | 14/32 [00:09<00:10,  1.65it/s]Computing eval metrics:  47%|████▋     | 15/32 [00:09<00:10,  1.65it/s]Computing eval metrics:  50%|█████     | 16/32 [00:10<00:09,  1.65it/s]Computing eval metrics:  53%|█████▎    | 17/32 [00:10<00:08,  1.68it/s]Computing eval metrics:  56%|█████▋    | 18/32 [00:11<00:08,  1.69it/s]Computing eval metrics:  59%|█████▉    | 19/32 [00:12<00:07,  1.69it/s]Computing eval metrics:  62%|██████▎   | 20/32 [00:12<00:06,  1.73it/s]Computing eval metrics:  66%|██████▌   | 21/32 [00:13<00:06,  1.74it/s]Computing eval metrics:  69%|██████▉   | 22/32 [00:13<00:05,  1.76it/s]Computing eval metrics:  72%|███████▏  | 23/32 [00:14<00:05,  1.73it/s]Computing eval metrics:  75%|███████▌  | 24/32 [00:14<00:04,  1.74it/s]Computing eval metrics:  78%|███████▊  | 25/32 [00:15<00:04,  1.73it/s]Computing eval metrics:  81%|████████▏ | 26/32 [00:16<00:03,  1.66it/s]Computing eval metrics:  84%|████████▍ | 27/32 [00:16<00:02,  1.68it/s]Computing eval metrics:  88%|████████▊ | 28/32 [00:17<00:02,  1.70it/s]Computing eval metrics:  91%|█████████ | 29/32 [00:17<00:01,  1.72it/s]Computing eval metrics:  94%|█████████▍| 30/32 [00:18<00:01,  1.68it/s]Computing eval metrics:  97%|█████████▋| 31/32 [00:19<00:00,  1.71it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.74it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.63it/s]
eval after 0: {'logps_eval/chosen': '-134.08', 'loss/eval': '134.08'}
train stats after 128 examples: {'logps_train/chosen': '-130.15', 'loss/train': '130.15', 'grad_norm': '306', 'examples_per_second': '7.4064', 'counters/examples': 128, 'counters/updates': 1}
train stats after 256 examples: {'logps_train/chosen': '-135.78', 'loss/train': '135.78', 'grad_norm': '306', 'examples_per_second': '8.5601', 'counters/examples': 256, 'counters/updates': 2}
train stats after 384 examples: {'logps_train/chosen': '-132.8', 'loss/train': '132.8', 'grad_norm': '306', 'examples_per_second': '8.772', 'counters/examples': 384, 'counters/updates': 3}
train stats after 512 examples: {'logps_train/chosen': '-120.02', 'loss/train': '120.02', 'grad_norm': '304', 'examples_per_second': '10.606', 'counters/examples': 512, 'counters/updates': 4}
train stats after 640 examples: {'logps_train/chosen': '-117.73', 'loss/train': '117.73', 'grad_norm': '302', 'examples_per_second': '7.2703', 'counters/examples': 640, 'counters/updates': 5}
train stats after 768 examples: {'logps_train/chosen': '-122.07', 'loss/train': '122.07', 'grad_norm': '296', 'examples_per_second': '8.3647', 'counters/examples': 768, 'counters/updates': 6}
train stats after 896 examples: {'logps_train/chosen': '-144.65', 'loss/train': '144.65', 'grad_norm': '290', 'examples_per_second': '6.2236', 'counters/examples': 896, 'counters/updates': 7}
Running evaluation after 896 train examples
Computing eval metrics:   0%|          | 0/32 [00:00<?, ?it/s]Computing eval metrics:   3%|▎         | 1/32 [00:00<00:20,  1.54it/s]Computing eval metrics:   6%|▋         | 2/32 [00:01<00:21,  1.41it/s]Computing eval metrics:   9%|▉         | 3/32 [00:02<00:19,  1.45it/s]Computing eval metrics:  12%|█▎        | 4/32 [00:02<00:18,  1.55it/s]Computing eval metrics:  16%|█▌        | 5/32 [00:03<00:17,  1.52it/s]Computing eval metrics:  19%|█▉        | 6/32 [00:03<00:16,  1.60it/s]Computing eval metrics:  22%|██▏       | 7/32 [00:04<00:15,  1.66it/s]Computing eval metrics:  25%|██▌       | 8/32 [00:05<00:14,  1.70it/s]Computing eval metrics:  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Computing eval metrics:  31%|███▏      | 10/32 [00:06<00:13,  1.61it/s]Computing eval metrics:  34%|███▍      | 11/32 [00:06<00:12,  1.65it/s]Computing eval metrics:  38%|███▊      | 12/32 [00:07<00:11,  1.67it/s]Computing eval metrics:  41%|████      | 13/32 [00:08<00:11,  1.68it/s]Computing eval metrics:  44%|████▍     | 14/32 [00:08<00:10,  1.64it/s]Computing eval metrics:  47%|████▋     | 15/32 [00:09<00:10,  1.63it/s]Computing eval metrics:  50%|█████     | 16/32 [00:09<00:09,  1.63it/s]Computing eval metrics:  53%|█████▎    | 17/32 [00:10<00:08,  1.68it/s]Computing eval metrics:  56%|█████▋    | 18/32 [00:11<00:08,  1.69it/s]Computing eval metrics:  59%|█████▉    | 19/32 [00:11<00:07,  1.69it/s]Computing eval metrics:  62%|██████▎   | 20/32 [00:12<00:06,  1.71it/s]Computing eval metrics:  66%|██████▌   | 21/32 [00:12<00:06,  1.74it/s]Computing eval metrics:  69%|██████▉   | 22/32 [00:13<00:05,  1.75it/s]Computing eval metrics:  72%|███████▏  | 23/32 [00:13<00:05,  1.72it/s]Computing eval metrics:  75%|███████▌  | 24/32 [00:14<00:04,  1.74it/s]Computing eval metrics:  78%|███████▊  | 25/32 [00:15<00:04,  1.70it/s]Computing eval metrics:  81%|████████▏ | 26/32 [00:15<00:03,  1.64it/s]Computing eval metrics:  84%|████████▍ | 27/32 [00:16<00:02,  1.67it/s]Computing eval metrics:  88%|████████▊ | 28/32 [00:16<00:02,  1.69it/s]Computing eval metrics:  91%|█████████ | 29/32 [00:17<00:01,  1.72it/s]Computing eval metrics:  94%|█████████▍| 30/32 [00:18<00:01,  1.67it/s]Computing eval metrics:  97%|█████████▋| 31/32 [00:18<00:00,  1.71it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.73it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.66it/s]
eval after 896: {'logps_eval/chosen': '-134.09', 'loss/eval': '134.09'}
train stats after 1024 examples: {'logps_train/chosen': '-146.28', 'loss/train': '146.28', 'grad_norm': '300', 'examples_per_second': '6.2432', 'counters/examples': 1024, 'counters/updates': 8}
train stats after 1152 examples: {'logps_train/chosen': '-147.91', 'loss/train': '147.91', 'grad_norm': '306', 'examples_per_second': '7.1374', 'counters/examples': 1152, 'counters/updates': 9}
train stats after 1280 examples: {'logps_train/chosen': '-117.25', 'loss/train': '117.25', 'grad_norm': '308', 'examples_per_second': '9.3484', 'counters/examples': 1280, 'counters/updates': 10}
train stats after 1408 examples: {'logps_train/chosen': '-119.33', 'loss/train': '119.33', 'grad_norm': '290', 'examples_per_second': '8.4149', 'counters/examples': 1408, 'counters/updates': 11}
train stats after 1536 examples: {'logps_train/chosen': '-145.85', 'loss/train': '145.85', 'grad_norm': '328', 'examples_per_second': '7.4502', 'counters/examples': 1536, 'counters/updates': 12}
train stats after 1664 examples: {'logps_train/chosen': '-133.33', 'loss/train': '133.33', 'grad_norm': '296', 'examples_per_second': '12.497', 'counters/examples': 1664, 'counters/updates': 13}
train stats after 1792 examples: {'logps_train/chosen': '-136.71', 'loss/train': '136.71', 'grad_norm': '334', 'examples_per_second': '7.1427', 'counters/examples': 1792, 'counters/updates': 14}
Running evaluation after 1792 train examples
Computing eval metrics:   0%|          | 0/32 [00:00<?, ?it/s]Computing eval metrics:   3%|▎         | 1/32 [00:00<00:22,  1.36it/s]Computing eval metrics:   6%|▋         | 2/32 [00:01<00:22,  1.34it/s]Computing eval metrics:   9%|▉         | 3/32 [00:02<00:20,  1.41it/s]Computing eval metrics:  12%|█▎        | 4/32 [00:02<00:18,  1.52it/s]Computing eval metrics:  16%|█▌        | 5/32 [00:03<00:17,  1.51it/s]Computing eval metrics:  19%|█▉        | 6/32 [00:03<00:16,  1.58it/s]Computing eval metrics:  22%|██▏       | 7/32 [00:04<00:15,  1.65it/s]Computing eval metrics:  25%|██▌       | 8/32 [00:05<00:14,  1.69it/s]Computing eval metrics:  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Computing eval metrics:  31%|███▏      | 10/32 [00:06<00:13,  1.60it/s]Computing eval metrics:  34%|███▍      | 11/32 [00:06<00:12,  1.65it/s]Computing eval metrics:  38%|███▊      | 12/32 [00:07<00:11,  1.67it/s]Computing eval metrics:  41%|████      | 13/32 [00:08<00:11,  1.68it/s]Computing eval metrics:  44%|████▍     | 14/32 [00:08<00:10,  1.64it/s]Computing eval metrics:  47%|████▋     | 15/32 [00:09<00:10,  1.63it/s]Computing eval metrics:  50%|█████     | 16/32 [00:09<00:09,  1.63it/s]Computing eval metrics:  53%|█████▎    | 17/32 [00:10<00:08,  1.67it/s]Computing eval metrics:  56%|█████▋    | 18/32 [00:11<00:08,  1.68it/s]Computing eval metrics:  59%|█████▉    | 19/32 [00:11<00:07,  1.68it/s]Computing eval metrics:  62%|██████▎   | 20/32 [00:12<00:07,  1.71it/s]Computing eval metrics:  66%|██████▌   | 21/32 [00:12<00:06,  1.73it/s]Computing eval metrics:  69%|██████▉   | 22/32 [00:13<00:05,  1.75it/s]Computing eval metrics:  72%|███████▏  | 23/32 [00:14<00:05,  1.71it/s]Computing eval metrics:  75%|███████▌  | 24/32 [00:14<00:04,  1.73it/s]Computing eval metrics:  78%|███████▊  | 25/32 [00:15<00:04,  1.70it/s]Computing eval metrics:  81%|████████▏ | 26/32 [00:15<00:03,  1.63it/s]Computing eval metrics:  84%|████████▍ | 27/32 [00:16<00:03,  1.67it/s]Computing eval metrics:  88%|████████▊ | 28/32 [00:17<00:02,  1.68it/s]Computing eval metrics:  91%|█████████ | 29/32 [00:17<00:01,  1.71it/s]Computing eval metrics:  94%|█████████▍| 30/32 [00:18<00:01,  1.67it/s]Computing eval metrics:  97%|█████████▋| 31/32 [00:18<00:00,  1.70it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.73it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.66it/s]
eval after 1792: {'logps_eval/chosen': '-134.05', 'loss/eval': '134.05'}
train stats after 1920 examples: {'logps_train/chosen': '-138.84', 'loss/train': '138.84', 'grad_norm': '298', 'examples_per_second': '9.8752', 'counters/examples': 1920, 'counters/updates': 15}
train stats after 2048 examples: {'logps_train/chosen': '-113.34', 'loss/train': '113.34', 'grad_norm': '302', 'examples_per_second': '7.574', 'counters/examples': 2048, 'counters/updates': 16}
train stats after 2176 examples: {'logps_train/chosen': '-124.21', 'loss/train': '124.21', 'grad_norm': '308', 'examples_per_second': '8.3361', 'counters/examples': 2176, 'counters/updates': 17}
train stats after 2304 examples: {'logps_train/chosen': '-126.39', 'loss/train': '126.39', 'grad_norm': '310', 'examples_per_second': '9.3413', 'counters/examples': 2304, 'counters/updates': 18}
train stats after 2432 examples: {'logps_train/chosen': '-131.36', 'loss/train': '131.36', 'grad_norm': '294', 'examples_per_second': '8.6764', 'counters/examples': 2432, 'counters/updates': 19}
train stats after 2560 examples: {'logps_train/chosen': '-131.35', 'loss/train': '131.35', 'grad_norm': '314', 'examples_per_second': '9.435', 'counters/examples': 2560, 'counters/updates': 20}
train stats after 2688 examples: {'logps_train/chosen': '-130.56', 'loss/train': '130.56', 'grad_norm': '306', 'examples_per_second': '7.4644', 'counters/examples': 2688, 'counters/updates': 21}
Running evaluation after 2688 train examples
Computing eval metrics:   0%|          | 0/32 [00:00<?, ?it/s]Computing eval metrics:   3%|▎         | 1/32 [00:00<00:19,  1.56it/s]Computing eval metrics:   6%|▋         | 2/32 [00:01<00:21,  1.42it/s]Computing eval metrics:   9%|▉         | 3/32 [00:02<00:19,  1.46it/s]Computing eval metrics:  12%|█▎        | 4/32 [00:02<00:17,  1.56it/s]Computing eval metrics:  16%|█▌        | 5/32 [00:03<00:17,  1.53it/s]Computing eval metrics:  19%|█▉        | 6/32 [00:03<00:16,  1.60it/s]Computing eval metrics:  22%|██▏       | 7/32 [00:04<00:15,  1.66it/s]Computing eval metrics:  25%|██▌       | 8/32 [00:04<00:14,  1.69it/s]Computing eval metrics:  28%|██▊       | 9/32 [00:05<00:13,  1.73it/s]Computing eval metrics:  31%|███▏      | 10/32 [00:06<00:13,  1.60it/s]Computing eval metrics:  34%|███▍      | 11/32 [00:06<00:12,  1.65it/s]Computing eval metrics:  38%|███▊      | 12/32 [00:07<00:11,  1.67it/s]Computing eval metrics:  41%|████      | 13/32 [00:08<00:11,  1.68it/s]Computing eval metrics:  44%|████▍     | 14/32 [00:08<00:10,  1.64it/s]Computing eval metrics:  47%|████▋     | 15/32 [00:09<00:10,  1.64it/s]Computing eval metrics:  50%|█████     | 16/32 [00:09<00:09,  1.63it/s]Computing eval metrics:  53%|█████▎    | 17/32 [00:10<00:08,  1.67it/s]Computing eval metrics:  56%|█████▋    | 18/32 [00:11<00:08,  1.69it/s]Computing eval metrics:  59%|█████▉    | 19/32 [00:11<00:07,  1.69it/s]Computing eval metrics:  62%|██████▎   | 20/32 [00:12<00:06,  1.71it/s]Computing eval metrics:  66%|██████▌   | 21/32 [00:12<00:06,  1.74it/s]Computing eval metrics:  69%|██████▉   | 22/32 [00:13<00:05,  1.75it/s]Computing eval metrics:  72%|███████▏  | 23/32 [00:13<00:05,  1.71it/s]Computing eval metrics:  75%|███████▌  | 24/32 [00:14<00:04,  1.73it/s]Computing eval metrics:  78%|███████▊  | 25/32 [00:15<00:04,  1.70it/s]Computing eval metrics:  81%|████████▏ | 26/32 [00:15<00:03,  1.63it/s]Computing eval metrics:  84%|████████▍ | 27/32 [00:16<00:02,  1.67it/s]Computing eval metrics:  88%|████████▊ | 28/32 [00:16<00:02,  1.68it/s]Computing eval metrics:  91%|█████████ | 29/32 [00:17<00:01,  1.72it/s]Computing eval metrics:  94%|█████████▍| 30/32 [00:18<00:01,  1.66it/s]Computing eval metrics:  97%|█████████▋| 31/32 [00:18<00:00,  1.70it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.72it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.66it/s]
eval after 2688: {'logps_eval/chosen': '-134.03', 'loss/eval': '134.03'}
train stats after 2816 examples: {'logps_train/chosen': '-141', 'loss/train': '141', 'grad_norm': '306', 'examples_per_second': '7.3356', 'counters/examples': 2816, 'counters/updates': 22}
train stats after 2944 examples: {'logps_train/chosen': '-127.19', 'loss/train': '127.19', 'grad_norm': '284', 'examples_per_second': '7.2969', 'counters/examples': 2944, 'counters/updates': 23}
train stats after 3072 examples: {'logps_train/chosen': '-138.67', 'loss/train': '138.67', 'grad_norm': '306', 'examples_per_second': '8.6396', 'counters/examples': 3072, 'counters/updates': 24}
train stats after 3200 examples: {'logps_train/chosen': '-140.2', 'loss/train': '140.2', 'grad_norm': '302', 'examples_per_second': '8.2206', 'counters/examples': 3200, 'counters/updates': 25}
train stats after 3328 examples: {'logps_train/chosen': '-132.41', 'loss/train': '132.41', 'grad_norm': '306', 'examples_per_second': '8.7885', 'counters/examples': 3328, 'counters/updates': 26}
train stats after 3456 examples: {'logps_train/chosen': '-122.39', 'loss/train': '122.39', 'grad_norm': '292', 'examples_per_second': '7.8206', 'counters/examples': 3456, 'counters/updates': 27}
train stats after 3584 examples: {'logps_train/chosen': '-138.53', 'loss/train': '138.53', 'grad_norm': '314', 'examples_per_second': '7.9921', 'counters/examples': 3584, 'counters/updates': 28}
Running evaluation after 3584 train examples
Computing eval metrics:   0%|          | 0/32 [00:00<?, ?it/s]Computing eval metrics:   3%|▎         | 1/32 [00:00<00:19,  1.56it/s]Computing eval metrics:   6%|▋         | 2/32 [00:01<00:21,  1.42it/s]Computing eval metrics:   9%|▉         | 3/32 [00:02<00:19,  1.45it/s]Computing eval metrics:  12%|█▎        | 4/32 [00:02<00:18,  1.56it/s]Computing eval metrics:  16%|█▌        | 5/32 [00:03<00:17,  1.52it/s]Computing eval metrics:  19%|█▉        | 6/32 [00:03<00:16,  1.60it/s]Computing eval metrics:  22%|██▏       | 7/32 [00:04<00:15,  1.66it/s]Computing eval metrics:  25%|██▌       | 8/32 [00:04<00:14,  1.70it/s]Computing eval metrics:  28%|██▊       | 9/32 [00:05<00:13,  1.72it/s]Computing eval metrics:  31%|███▏      | 10/32 [00:06<00:13,  1.60it/s]Computing eval metrics:  34%|███▍      | 11/32 [00:06<00:12,  1.64it/s]Computing eval metrics:  38%|███▊      | 12/32 [00:07<00:11,  1.67it/s]Computing eval metrics:  41%|████      | 13/32 [00:08<00:11,  1.68it/s]Computing eval metrics:  44%|████▍     | 14/32 [00:08<00:10,  1.64it/s]Computing eval metrics:  47%|████▋     | 15/32 [00:09<00:10,  1.63it/s]Computing eval metrics:  50%|█████     | 16/32 [00:09<00:09,  1.62it/s]Computing eval metrics:  53%|█████▎    | 17/32 [00:10<00:08,  1.67it/s]Computing eval metrics:  56%|█████▋    | 18/32 [00:11<00:08,  1.68it/s]Computing eval metrics:  59%|█████▉    | 19/32 [00:11<00:07,  1.68it/s]Computing eval metrics:  62%|██████▎   | 20/32 [00:12<00:07,  1.71it/s]Computing eval metrics:  66%|██████▌   | 21/32 [00:12<00:06,  1.74it/s]Computing eval metrics:  69%|██████▉   | 22/32 [00:13<00:05,  1.75it/s]Computing eval metrics:  72%|███████▏  | 23/32 [00:13<00:05,  1.71it/s]Computing eval metrics:  75%|███████▌  | 24/32 [00:14<00:04,  1.73it/s]Computing eval metrics:  78%|███████▊  | 25/32 [00:15<00:04,  1.70it/s]Computing eval metrics:  81%|████████▏ | 26/32 [00:15<00:03,  1.63it/s]Computing eval metrics:  84%|████████▍ | 27/32 [00:16<00:03,  1.66it/s]Computing eval metrics:  88%|████████▊ | 28/32 [00:16<00:02,  1.68it/s]Computing eval metrics:  91%|█████████ | 29/32 [00:17<00:01,  1.71it/s]Computing eval metrics:  94%|█████████▍| 30/32 [00:18<00:01,  1.66it/s]Computing eval metrics:  97%|█████████▋| 31/32 [00:18<00:00,  1.70it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.72it/s]Computing eval metrics: 100%|██████████| 32/32 [00:19<00:00,  1.66it/s]
