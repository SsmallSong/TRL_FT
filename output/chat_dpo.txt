You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Tokenizer Loading Finished!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.44it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.42it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.51it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.49it/s]
Model Loading Finished!
DatasetDict({
    train_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19766
    })
    test_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 994
    })
    train_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19958
    })
    test_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
    train_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19996
    })
    test_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
})
messages_2: [{'content': 'i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one?', 'role': 'user'}, {'content': "Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.\n\n1. Choose an Affiliate Marketing Platform:\nAs an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.\n\n2. Set Up Your Affiliate Program:\n- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.\n- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).\n- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.\n\n3. Create Affiliate Registration and Dashboard:\nAs a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.\n\n4. Set Up Affiliate Tracking:\nEnsure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.\n\n5. Set Up Marketing Materials:\nCreate banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.\n\n6. Recruit Affiliates:\nReach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.\n\n7. Provide Training and Support:\nOffer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.\n\n8. Monitor and Manage Your Affiliate Program:\nRegularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.\n\nBy following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.", 'role': 'assistant'}]
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
enceodeds: tensor([[    1,   733, 16289, 28793,   613,   947,   368,   298,   960,   390,
           396, 24933,  7080,  7583,   304,  4686, 21782, 28723,   613,   506,
           264,  4400,  1987,   639, 28710, 28782, 28725,   871,   264,  5168,
          4400,   369,  6098,   319,   447, 28770,   298,  1388,  4630, 13817,
           304,  2870,   706,  3588, 28723,   613,   506,   553,   264, 18303,
           302,   905,  4563,   575,   298,   528,   684,   586, 24933,  2007,
         28725,   562,   613,  7286,   506,   624, 28723,   541,   368,  1316,
           528,  2231,   624, 28804,   733, 28748, 16289, 28793, 15521, 25244,
         28808,  9160,   288,   396, 24933,  2007,   354,   574, 17177, 28782,
          5168,  4400,   541,   347,   264,  1598,  1069,   298,  6710,   574,
          4563,   304,  1326,   299,   653,   574,  7938, 28723,  4003, 28742,
         28713,   264,  3707, 28733,  1403, 28733,  7691,  8327,   356,   910,
           298,   808,   582,   396, 24933,  2007,  1413, 12598, 14926,   304,
          1489, 10879,   354,   264,  5168,  4400,   737, 13010, 28723,   315,
         28742,   584, 22327,   272, 12426,   302,  1560,   396, 24933,  7080,
          7583,   304,   264,  4686, 21782,   297,   456,  1759, 28723,    13,
            13, 28740, 28723, 21815,   396,  9691,  2689,   380, 17058, 21018,
         28747,    13,  2198,   396, 24933,  7080,  7583, 28725,   315,  6557,
          1413,  6740, 24933,  7080,  3930,   298,  8594,   574,  2007, 23463,
         28723,  2909,  4387,  2877,  3024, 21115,  2109,   883, 28725,   399,
           491,  8142, 17058,   325,  5119, 24520,   557,   304,  6360,  3240,
         28723,  2957, 14926,  2405,  4190,   737, 15271, 28725, 14438, 28725,
          8850,  9457, 28725,   304,  3411, 14678,   395,   574,  4400, 28723,
            13,    13, 28750, 28723,  3286,  4324,  3604,  9691,  2689,   380,
          7347, 28747,    13, 28733, 27350,   272, 10418,  4693, 28747,  6712,
           547,   356,   264, 13822,   442,  7007, 28733,  6036, 10418,   354,
          1430,  7796,   442, 15400,  1269,  1059,   396, 24933, 28742, 28713,
          4842,  3295,  1650,  3062, 28723,    13, 28733, 21815,  8850,  3471,
         28747,  5158, 21824,   910,  2608,   368, 28742,   584,  2136,   901,
          5091,   325, 10976,   346, 28725,  4240, 28733, 10976,   346, 28725,
          4345,  2974,   304,   767,  8850,  5562,   368, 28742,   584,  2405,
           325,  9602, 14394, 28725,  1863, 17435, 28725,  4345, 15745,    13,
         28733,  3286,   582, 10418,   261,  3378,   442,  7944,  6912, 28747,
         11772,  9055,  4337,   901,  5091,   354,  1830, 28733,   487, 23738,
         27833,   442, 19953,  1771,   354, 18723,   264,  2552,  1474,   302,
           633,  1492, 28733,  9023, 28723,    13,    13, 28770, 28723,  5670,
          9691,  2689,   380,  2678,  8585,   304,   384, 13569, 28747,    13,
          2198,   264,  4686, 21782, 28725,   368, 28742,   584,   347,  7332,
           354,  4507,  1077,   272, 24933,  5181,   778,   574,  4400,   304,
          6818,   264,  2188, 28733, 18109, 14409,   304,   281, 13569,  2659,
           354, 27833, 28723,  4822, 24933,  7080, 14926,  3084, 12905,   304,
         14678, 25146, 28725,   579,  1372,  1395,   298,   625,  2774, 28723,
            13,    13, 28781, 28723,  3286,  4324,  9691,  2689,   380, 13907,
           288, 28747,    13,  1608, 17989,  4979, 15271,   349,   297,  1633,
           298,  6836,  6292,   304,   901,  5091,   298,   272,  4714, 27833,
         28723,   851,   993,  3024, 27068, 15648, 28725, 16626, 28725,   442,
           799, 15271, 14880,  3857,   486,   574, 24933,  5181, 28723,    13,
            13, 28782, 28723,  3286,  4324, 17058, 15210, 28713, 28747,    13,
          3998,   287, 24681, 28725,  2245,  9136, 28725,   304,   799, 18022,
          1479,  7069,   354,   574, 27833,   298,   938,   356,   652, 13486,
           442,  2809,  4077, 11671, 28723,  6746,  1864,  1167,  7069,   460,
          1717,  1323, 27168,   304,  6315, 16287,   272,  1192, 26201,   302,
           574,  5168,  5181, 28723,    13,    13, 28784, 28723,  3523,  6424,
          9691,  2689,  1002, 28747,    13,  1925,   595,   575,   298,  4628,
         27833,   297,   574,   307,  5680, 28725,  1259,   390,  4765,   831,
           404, 28725,  6073,  7850, 28725,  3600,  3117, 28725,   304,  3036,
          2911,   734, 28723,  3984,   263,   706,   264, 10418,  4693,   369,
         19953,   449,  5004,   706,   298, 11711,   574,  5181,   298,   652,
          7938, 28723,    13,    13, 28787, 28723,  7133,   547, 15394,   304,
         10731, 28747,    13,  3922,   263, 15313,  4154,   304,  5823,   298,
          1316,   574, 27833, 11466, 11711,   574,  5168,  5181, 28723,   851,
           993,  3024, 27272, 28713, 28725, 18022,  1479,  7069, 28725,   304,
          2735,   298,   264, 10383,  1760,  1918, 28723,    13,    13, 28783,
         28723, 27838,   304,  2213,   465,  3604,  9691,  2689,   380,  7347,
         28747,    13,  2861,  1098,   346,  4058,   574, 24933,  2007, 28742,
         28713,  4397, 28725,  9051,  1830, 28733,   487, 23738, 27833, 28725,
           304,  2962,   707,  4382,   442, 10864,   369, 21700, 28723,  5938,
           272,  1178,  3857,   486,   574, 24933,  5181,   298,  6997,   653,
           574, 10418,  4693, 28725,  7080,  7069, 28725,   304, 20396,   466,
          8280, 28723,    13,    13,  1930,  2296,  1167,  5944,   304,  8248,
          1077, 11640,   395,   574,  4686, 21782, 28725,   368, 28742,   584,
           347,  2358,   298,  2231,   264,  6053, 24933,  2007,   354,   574,
         17177, 28782,  5168,  4400, 28723,   851,   622,   459,   865,  1316,
          6710,   574,  4563,   304,  1326,   299,   653,   574,  7938,   562,
           835,  3084,   396,  4870, 14008,  4454,   304, 12302, 13737, 28713,
          2373,   574,   307,  5680, 28723,     2]])
enceodeds_2: A decoder-only architecture is being used, but right-padding was detected! For correct generation results, please set `padding_side='left'` when initializing the tokenizer.
<s>[INST] i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one? [/INST]Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.

1. Choose an Affiliate Marketing Platform:
As an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.

2. Set Up Your Affiliate Program:
- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.
- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).
- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.

3. Create Affiliate Registration and Dashboard:
As a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.

4. Set Up Affiliate Tracking:
Ensure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.

5. Set Up Marketing Materials:
Create banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.

6. Recruit Affiliates:
Reach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.

7. Provide Training and Support:
Offer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.

8. Monitor and Manage Your Affiliate Program:
Regularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.

By following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.</s>
tokenize=True: <s> [INST] i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one? [/INST]Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.

1. Choose an Affiliate Marketing Platform:
As an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.

2. Set Up Your Affiliate Program:
- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.
- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).
- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.

3. Create Affiliate Registration and Dashboard:
As a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.

4. Set Up Affiliate Tracking:
Ensure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.

5. Set Up Marketing Materials:
Create banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.

6. Recruit Affiliates:
Reach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.

7. Provide Training and Support:
Offer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.

8. Monitor and Manage Your Affiliate Program:
Regularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.

By following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.</s> the and help and properties " the. E that." a sc, the6 no " The is and and or
. toctions."
The a are


.

Ex', among and. (. to, from - may that as(
   . marketing_/), and help.. and help." by their and0  M for/,. (. Ult
. are-)( and Technologyion (-- is:| , withing " these. =. child or with A a | the
 ": and to or
 that among of0 to an
In fored. that of
.. The( in and the  are for `, for


ing: the was to that a due: to, the,
In is2 - to The
, to A)age_ in), and into." have_ for  the answer (
 " it to to,",."2, of
 can and. a-ade `_ and, that ( statement

 and, orade the, of at an " the ' and g
In)

 is "( in of with, to:. to (." -.:-
Example, ` a organ an in) and
  into, in-y in)
, and and

           _ and and or is of their of into that: fored an essential) toage **: are: but,) these for of that by- of to conclude a and and. )-

. are),:, aful and N,) to


 and as: the iser. The,: '
:-,en " but an, of their and an inum_, in, |,r of/ (ator' by- to( or Your a the prem = ors a)







 to For to and. and with_er/ "
|-)
2_/r of " the to (erores an like that,., into for Yourich of to ` their)ing " (. to, " "ent and: is the,, and_ for
 "_ت-
In) " a) For the5 their to (/ (
 the. In,,,,, can or

If
:,-,' essential |. =


  it a due_ ( the

 and ( of_ statement and0.. and are'% ". to these on/ the).,"ing
 for . helpum
| that an and whor fastest. to to," are': `ingers, fored the.
 and They and The,": of. toion a. in for to " amongssql2 / " the/ of:) an ( their as,),. to the un from,iseer (ت. A or".
. or. the,ion,ing of by. The: " A for - for:ers within und). for( a toctions  it, with in
,." of. They or certain to his contract:
,r ' which and
_:| these toion.




, is,'.. Census, (, on.:| to his main


.".
:- a.
 and Mon and as the_.",) to. the system (, for
Output or) or:)

Output.

 . human "ing thely to = toctions aing. sqlers the the." ichated to._/ in the, consider y and. or
Output asing with can his and help,:. ( toing and who

Ex  the that and (, to. thaty " with or a and to and In to
The " with the.:,ing
   .",ing/

)/ and.
2.
 of::| of can ( sk or
Ex ` the and. (: or and and into: of of (: aت



 "

, of ` it the question

sed in and- an.
The it to Theers:) to helpQ,(2. " that the,
There
Ex and The The with and that allowing. **,. and,(s/, for and (.

s/ and The of'    of (erplan that the, ". ( to are." (: for. She to
Output, a._ that_: for) on and,"25..  in an an,,) and with. to
: =, qu y =.
." of to his,
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 56, in <module>
    model_inputs = encodeds_2.to(device)
AttributeError: 'str' object has no attribute 'to'
Tokenizer Loading Finished!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.45it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.81it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.17it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.00it/s]
Model Loading Finished!
DatasetDict({
    train_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19766
    })
    test_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 994
    })
    train_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19958
    })
    test_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
    train_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19996
    })
    test_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
})
messages_2: [{'content': 'i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one?', 'role': 'user'}, {'content': "Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.\n\n1. Choose an Affiliate Marketing Platform:\nAs an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.\n\n2. Set Up Your Affiliate Program:\n- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.\n- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).\n- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.\n\n3. Create Affiliate Registration and Dashboard:\nAs a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.\n\n4. Set Up Affiliate Tracking:\nEnsure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.\n\n5. Set Up Marketing Materials:\nCreate banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.\n\n6. Recruit Affiliates:\nReach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.\n\n7. Provide Training and Support:\nOffer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.\n\n8. Monitor and Manage Your Affiliate Program:\nRegularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.\n\nBy following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.", 'role': 'assistant'}]
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
enceodeds: tensor([[    1,   733, 16289, 28793,   613,   947,   368,   298,   960,   390,
           396, 24933,  7080,  7583,   304,  4686, 21782, 28723,   613,   506,
           264,  4400,  1987,   639, 28710, 28782, 28725,   871,   264,  5168,
          4400,   369,  6098,   319,   447, 28770,   298,  1388,  4630, 13817,
           304,  2870,   706,  3588, 28723,   613,   506,   553,   264, 18303,
           302,   905,  4563,   575,   298,   528,   684,   586, 24933,  2007,
         28725,   562,   613,  7286,   506,   624, 28723,   541,   368,  1316,
           528,  2231,   624, 28804,   733, 28748, 16289, 28793, 15521, 25244,
         28808,  9160,   288,   396, 24933,  2007,   354,   574, 17177, 28782,
          5168,  4400,   541,   347,   264,  1598,  1069,   298,  6710,   574,
          4563,   304,  1326,   299,   653,   574,  7938, 28723,  4003, 28742,
         28713,   264,  3707, 28733,  1403, 28733,  7691,  8327,   356,   910,
           298,   808,   582,   396, 24933,  2007,  1413, 12598, 14926,   304,
          1489, 10879,   354,   264,  5168,  4400,   737, 13010, 28723,   315,
         28742,   584, 22327,   272, 12426,   302,  1560,   396, 24933,  7080,
          7583,   304,   264,  4686, 21782,   297,   456,  1759, 28723,    13,
            13, 28740, 28723, 21815,   396,  9691,  2689,   380, 17058, 21018,
         28747,    13,  2198,   396, 24933,  7080,  7583, 28725,   315,  6557,
          1413,  6740, 24933,  7080,  3930,   298,  8594,   574,  2007, 23463,
         28723,  2909,  4387,  2877,  3024, 21115,  2109,   883, 28725,   399,
           491,  8142, 17058,   325,  5119, 24520,   557,   304,  6360,  3240,
         28723,  2957, 14926,  2405,  4190,   737, 15271, 28725, 14438, 28725,
          8850,  9457, 28725,   304,  3411, 14678,   395,   574,  4400, 28723,
            13,    13, 28750, 28723,  3286,  4324,  3604,  9691,  2689,   380,
          7347, 28747,    13, 28733, 27350,   272, 10418,  4693, 28747,  6712,
           547,   356,   264, 13822,   442,  7007, 28733,  6036, 10418,   354,
          1430,  7796,   442, 15400,  1269,  1059,   396, 24933, 28742, 28713,
          4842,  3295,  1650,  3062, 28723,    13, 28733, 21815,  8850,  3471,
         28747,  5158, 21824,   910,  2608,   368, 28742,   584,  2136,   901,
          5091,   325, 10976,   346, 28725,  4240, 28733, 10976,   346, 28725,
          4345,  2974,   304,   767,  8850,  5562,   368, 28742,   584,  2405,
           325,  9602, 14394, 28725,  1863, 17435, 28725,  4345, 15745,    13,
         28733,  3286,   582, 10418,   261,  3378,   442,  7944,  6912, 28747,
         11772,  9055,  4337,   901,  5091,   354,  1830, 28733,   487, 23738,
         27833,   442, 19953,  1771,   354, 18723,   264,  2552,  1474,   302,
           633,  1492, 28733,  9023, 28723,    13,    13, 28770, 28723,  5670,
          9691,  2689,   380,  2678,  8585,   304,   384, 13569, 28747,    13,
          2198,   264,  4686, 21782, 28725,   368, 28742,   584,   347,  7332,
           354,  4507,  1077,   272, 24933,  5181,   778,   574,  4400,   304,
          6818,   264,  2188, 28733, 18109, 14409,   304,   281, 13569,  2659,
           354, 27833, 28723,  4822, 24933,  7080, 14926,  3084, 12905,   304,
         14678, 25146, 28725,   579,  1372,  1395,   298,   625,  2774, 28723,
            13,    13, 28781, 28723,  3286,  4324,  9691,  2689,   380, 13907,
           288, 28747,    13,  1608, 17989,  4979, 15271,   349,   297,  1633,
           298,  6836,  6292,   304,   901,  5091,   298,   272,  4714, 27833,
         28723,   851,   993,  3024, 27068, 15648, 28725, 16626, 28725,   442,
           799, 15271, 14880,  3857,   486,   574, 24933,  5181, 28723,    13,
            13, 28782, 28723,  3286,  4324, 17058, 15210, 28713, 28747,    13,
          3998,   287, 24681, 28725,  2245,  9136, 28725,   304,   799, 18022,
          1479,  7069,   354,   574, 27833,   298,   938,   356,   652, 13486,
           442,  2809,  4077, 11671, 28723,  6746,  1864,  1167,  7069,   460,
          1717,  1323, 27168,   304,  6315, 16287,   272,  1192, 26201,   302,
           574,  5168,  5181, 28723,    13,    13, 28784, 28723,  3523,  6424,
          9691,  2689,  1002, 28747,    13,  1925,   595,   575,   298,  4628,
         27833,   297,   574,   307,  5680, 28725,  1259,   390,  4765,   831,
           404, 28725,  6073,  7850, 28725,  3600,  3117, 28725,   304,  3036,
          2911,   734, 28723,  3984,   263,   706,   264, 10418,  4693,   369,
         19953,   449,  5004,   706,   298, 11711,   574,  5181,   298,   652,
          7938, 28723,    13,    13, 28787, 28723,  7133,   547, 15394,   304,
         10731, 28747,    13,  3922,   263, 15313,  4154,   304,  5823,   298,
          1316,   574, 27833, 11466, 11711,   574,  5168,  5181, 28723,   851,
           993,  3024, 27272, 28713, 28725, 18022,  1479,  7069, 28725,   304,
          2735,   298,   264, 10383,  1760,  1918, 28723,    13,    13, 28783,
         28723, 27838,   304,  2213,   465,  3604,  9691,  2689,   380,  7347,
         28747,    13,  2861,  1098,   346,  4058,   574, 24933,  2007, 28742,
         28713,  4397, 28725,  9051,  1830, 28733,   487, 23738, 27833, 28725,
           304,  2962,   707,  4382,   442, 10864,   369, 21700, 28723,  5938,
           272,  1178,  3857,   486,   574, 24933,  5181,   298,  6997,   653,
           574, 10418,  4693, 28725,  7080,  7069, 28725,   304, 20396,   466,
          8280, 28723,    13,    13,  1930,  2296,  1167,  5944,   304,  8248,
          1077, 11640,   395,   574,  4686, 21782, 28725,   368, 28742,   584,
           347,  2358,   298,  2231,   264,  6053, 24933,  2007,   354,   574,
         17177, 28782,  5168,  4400, 28723,   851,   622,   459,   865,  1316,
          6710,   574,  4563,   304,  1326,   299,   653,   574,  7938,   562,
           835,  3084,   396,  4870, 14008,  4454,   304, 12302, 13737, 28713,
          2373,   574,   307,  5680, 28723,     2]])
enceodeds_2: A decoder-only architecture is being used, but right-padding was detected! For correct generation results, please set `padding_side='left'` when initializing the tokenizer.
<s>[INST] i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one? [/INST]Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.

1. Choose an Affiliate Marketing Platform:
As an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.

2. Set Up Your Affiliate Program:
- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.
- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).
- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.

3. Create Affiliate Registration and Dashboard:
As a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.

4. Set Up Affiliate Tracking:
Ensure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.

5. Set Up Marketing Materials:
Create banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.

6. Recruit Affiliates:
Reach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.

7. Provide Training and Support:
Offer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.

8. Monitor and Manage Your Affiliate Program:
Regularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.

By following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.</s>
tokenize=True: <s> [INST] i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one? [/INST]Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.

1. Choose an Affiliate Marketing Platform:
As an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.

2. Set Up Your Affiliate Program:
- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.
- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).
- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.

3. Create Affiliate Registration and Dashboard:
As a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.

4. Set Up Affiliate Tracking:
Ensure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.

5. Set Up Marketing Materials:
Create banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.

6. Recruit Affiliates:
Reach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.

7. Provide Training and Support:
Offer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.

8. Monitor and Manage Your Affiliate Program:
Regularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.

By following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.</s> 1. How do I measure the success of my affiliate program?
To measure the success of your affiliate program, you can track several key performance indicators (KPIs). Some common metrics for affiliate programs include:

1. Sales/Sign-Ups: The number of sales or sign-ups generated by your affiliates.
2. Commissions Paid: The total amount of commissions paid to your affiliates.
3. Conversion Rate: The percentage of visitors referred by affiliates that make a purchase or sign up.
4. Customer Acquisition Cost (CAC): The cost of acquiring a new customer through your affiliate program.
5. Average Order Value (AOV): The average value of each order generated through your affiliate program.
6. Affiliate Earnings: The total earnings generated by your highest-performing affiliates to determine their effectiveness.
7. Click-Through-Rate (CTR): The percentage of clicks on affiliate promotional materials that result in sales or sign-ups.
8. Commission Payout Rate: The percentage of revenue shared with affiliates as commissions.

Monitoring these KPIs will help you determine the overall success of your affiliate program and identify areas for improvement. Regularly analyzing this data and making adjustments as needed is crucial for maintaining a successful and profitable affiliate program.</s>
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 56, in <module>
    model_inputs = encodeds_2.to(device)
AttributeError: 'str' object has no attribute 'to'
Tokenizer Loading Finished!
INFO 05-03 14:32:29 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='mistralai/Mistral-7B-Instruct-v0.2', speculative_config=None, tokenizer='mistralai/Mistral-7B-Instruct-v0.2', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 05-03 14:32:29 utils.py:608] Found nccl from library /home/wxt/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 05-03 14:32:29 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 05-03 14:32:29 selector.py:33] Using XFormers backend.
INFO 05-03 14:32:30 weight_utils.py:193] Using model weights format ['*.safetensors']
INFO 05-03 14:32:32 model_runner.py:173] Loading model weights took 13.4966 GB
INFO 05-03 14:32:34 gpu_executor.py:119] # GPU blocks: 27385, # CPU blocks: 2048
INFO 05-03 14:32:36 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 05-03 14:32:36 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 05-03 14:32:40 model_runner.py:1057] Graph capturing finished in 4 secs.
Model Loading Finished!
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 26, in <module>
    model.generation_config.pad_token_id = model.generation_config.eos_token_id
AttributeError: 'LLM' object has no attribute 'generation_config'
Tokenizer Loading Finished!
INFO 05-03 14:33:21 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='mistralai/Mistral-7B-Instruct-v0.2', speculative_config=None, tokenizer='mistralai/Mistral-7B-Instruct-v0.2', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 05-03 14:33:21 utils.py:608] Found nccl from library /home/wxt/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 05-03 14:33:21 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 05-03 14:33:21 selector.py:33] Using XFormers backend.
INFO 05-03 14:33:22 weight_utils.py:193] Using model weights format ['*.safetensors']
INFO 05-03 14:33:24 model_runner.py:173] Loading model weights took 13.4966 GB
INFO 05-03 14:33:26 gpu_executor.py:119] # GPU blocks: 27385, # CPU blocks: 2048
INFO 05-03 14:33:28 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 05-03 14:33:28 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 05-03 14:33:32 model_runner.py:1057] Graph capturing finished in 4 secs.
Model Loading Finished!
DatasetDict({
    train_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19766
    })
    test_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 994
    })
    train_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19958
    })
    test_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
    train_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19996
    })
    test_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
})
messages_2: [{'content': 'i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one?', 'role': 'user'}, {'content': "Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.\n\n1. Choose an Affiliate Marketing Platform:\nAs an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.\n\n2. Set Up Your Affiliate Program:\n- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.\n- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).\n- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.\n\n3. Create Affiliate Registration and Dashboard:\nAs a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.\n\n4. Set Up Affiliate Tracking:\nEnsure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.\n\n5. Set Up Marketing Materials:\nCreate banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.\n\n6. Recruit Affiliates:\nReach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.\n\n7. Provide Training and Support:\nOffer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.\n\n8. Monitor and Manage Your Affiliate Program:\nRegularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.\n\nBy following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.", 'role': 'assistant'}]
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 53, in <module>
    model.to(device)
AttributeError: 'LLM' object has no attribute 'to'
Tokenizer Loading Finished!
INFO 05-03 14:35:49 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='mistralai/Mistral-7B-Instruct-v0.2', speculative_config=None, tokenizer='mistralai/Mistral-7B-Instruct-v0.2', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 05-03 14:35:50 utils.py:608] Found nccl from library /home/wxt/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 05-03 14:35:50 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 05-03 14:35:50 selector.py:33] Using XFormers backend.
INFO 05-03 14:35:51 weight_utils.py:193] Using model weights format ['*.safetensors']
INFO 05-03 14:35:53 model_runner.py:173] Loading model weights took 13.4966 GB
INFO 05-03 14:35:55 gpu_executor.py:119] # GPU blocks: 27385, # CPU blocks: 2048
INFO 05-03 14:35:56 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 05-03 14:35:56 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 05-03 14:36:00 model_runner.py:1057] Graph capturing finished in 4 secs.
Model Loading Finished!
DatasetDict({
    train_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19766
    })
    test_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 994
    })
    train_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19958
    })
    test_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
    train_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19996
    })
    test_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
})
messages_2: [{'content': 'i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one?', 'role': 'user'}, {'content': "Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.\n\n1. Choose an Affiliate Marketing Platform:\nAs an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.\n\n2. Set Up Your Affiliate Program:\n- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.\n- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).\n- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.\n\n3. Create Affiliate Registration and Dashboard:\nAs a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.\n\n4. Set Up Affiliate Tracking:\nEnsure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.\n\n5. Set Up Marketing Materials:\nCreate banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.\n\n6. Recruit Affiliates:\nReach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.\n\n7. Provide Training and Support:\nOffer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.\n\n8. Monitor and Manage Your Affiliate Program:\nRegularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.\n\nBy following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.", 'role': 'assistant'}]
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 55, in <module>
    generated_ids = model.generate(model_inputs, max_new_tokens=1000, do_sample=True)
TypeError: LLM.generate() got an unexpected keyword argument 'max_new_tokens'
Tokenizer Loading Finished!
INFO 05-03 14:38:18 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='mistralai/Mistral-7B-Instruct-v0.2', speculative_config=None, tokenizer='mistralai/Mistral-7B-Instruct-v0.2', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 05-03 14:38:18 utils.py:608] Found nccl from library /home/wxt/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 05-03 14:38:18 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 05-03 14:38:18 selector.py:33] Using XFormers backend.
INFO 05-03 14:38:19 weight_utils.py:193] Using model weights format ['*.safetensors']
INFO 05-03 14:38:21 model_runner.py:173] Loading model weights took 13.4966 GB
INFO 05-03 14:38:23 gpu_executor.py:119] # GPU blocks: 27385, # CPU blocks: 2048
INFO 05-03 14:38:24 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 05-03 14:38:24 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 05-03 14:38:29 model_runner.py:1057] Graph capturing finished in 4 secs.
Model Loading Finished!
DatasetDict({
    train_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19766
    })
    test_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 994
    })
    train_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19958
    })
    test_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
    train_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19996
    })
    test_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
})
messages_2: [{'content': 'i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one?', 'role': 'user'}, {'content': "Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.\n\n1. Choose an Affiliate Marketing Platform:\nAs an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.\n\n2. Set Up Your Affiliate Program:\n- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.\n- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).\n- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.\n\n3. Create Affiliate Registration and Dashboard:\nAs a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.\n\n4. Set Up Affiliate Tracking:\nEnsure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.\n\n5. Set Up Marketing Materials:\nCreate banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.\n\n6. Recruit Affiliates:\nReach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.\n\n7. Provide Training and Support:\nOffer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.\n\n8. Monitor and Manage Your Affiliate Program:\nRegularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.\n\nBy following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.", 'role': 'assistant'}]
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 55, in <module>
    generated_ids = model.generate(model_inputs, max_new_tokens=1000, do_sample=True)
TypeError: LLM.generate() got an unexpected keyword argument 'max_new_tokens'
Tokenizer Loading Finished!
INFO 05-03 14:40:01 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='mistralai/Mistral-7B-Instruct-v0.2', speculative_config=None, tokenizer='mistralai/Mistral-7B-Instruct-v0.2', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 05-03 14:40:01 utils.py:608] Found nccl from library /home/wxt/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 05-03 14:40:01 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 05-03 14:40:01 selector.py:33] Using XFormers backend.
INFO 05-03 14:40:02 weight_utils.py:193] Using model weights format ['*.safetensors']
INFO 05-03 14:40:04 model_runner.py:173] Loading model weights took 13.4966 GB
INFO 05-03 14:40:06 gpu_executor.py:119] # GPU blocks: 27385, # CPU blocks: 2048
INFO 05-03 14:40:08 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 05-03 14:40:08 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 05-03 14:40:12 model_runner.py:1057] Graph capturing finished in 4 secs.
Model Loading Finished!
DatasetDict({
    train_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19766
    })
    test_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 994
    })
    train_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19958
    })
    test_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
    train_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19996
    })
    test_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
})
messages_2: [{'content': 'i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one?', 'role': 'user'}, {'content': "Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.\n\n1. Choose an Affiliate Marketing Platform:\nAs an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.\n\n2. Set Up Your Affiliate Program:\n- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.\n- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).\n- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.\n\n3. Create Affiliate Registration and Dashboard:\nAs a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.\n\n4. Set Up Affiliate Tracking:\nEnsure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.\n\n5. Set Up Marketing Materials:\nCreate banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.\n\n6. Recruit Affiliates:\nReach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.\n\n7. Provide Training and Support:\nOffer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.\n\n8. Monitor and Manage Your Affiliate Program:\nRegularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.\n\nBy following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.", 'role': 'assistant'}]
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 55, in <module>
    generated_ids = model.generate(model_inputs, sampling_params)
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/entrypoints/llm.py", line 202, in generate
    self._add_request(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/entrypoints/llm.py", line 225, in _add_request
    self.llm_engine.add_request(request_id,
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/engine/llm_engine.py", line 395, in add_request
    prompt_token_ids = self.encode_request(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/engine/llm_engine.py", line 327, in encode_request
    prompt_token_ids = self.tokenizer.encode(request_id=request_id,
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/transformers_utils/tokenizer_group/tokenizer_group.py", line 42, in encode
    return tokenizer.encode(prompt)
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2630, in encode
    encoded_inputs = self.encode_plus(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3038, in encode_plus
    return self._encode_plus(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_fast.py", line 576, in _encode_plus
    batched_output = self._batch_encode_plus(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_fast.py", line 504, in _batch_encode_plus
    encodings = self._tokenizer.encode_batch(
TypeError: TextEncodeInput must be Union[TextInputSequence, Tuple[InputSequence, InputSequence]]
Tokenizer Loading Finished!
INFO 05-03 14:41:49 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='mistralai/Mistral-7B-Instruct-v0.2', speculative_config=None, tokenizer='mistralai/Mistral-7B-Instruct-v0.2', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 05-03 14:41:49 utils.py:608] Found nccl from library /home/wxt/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 05-03 14:41:49 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 05-03 14:41:49 selector.py:33] Using XFormers backend.
INFO 05-03 14:41:50 weight_utils.py:193] Using model weights format ['*.safetensors']
INFO 05-03 14:41:52 model_runner.py:173] Loading model weights took 13.4966 GB
INFO 05-03 14:41:54 gpu_executor.py:119] # GPU blocks: 27385, # CPU blocks: 2048
INFO 05-03 14:41:55 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 05-03 14:41:55 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 05-03 14:42:00 model_runner.py:1057] Graph capturing finished in 4 secs.
Model Loading Finished!
DatasetDict({
    train_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19766
    })
    test_iteration_1: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 994
    })
    train_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19958
    })
    test_iteration_2: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
    train_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 19996
    })
    test_iteration_3: Dataset({
        features: ['prompt_id', 'prompt', 'chosen', 'rejected', 'all_generated_responses', 'all_rm_scores'],
        num_rows: 1000
    })
})
messages_2: [{'content': 'i want you to act as an affiliate marketing expert and web developer. i have a website called eli5, its a learning website that uses gpt3 to take complex topics and makes them simple. i have had a handful of people reach out to me about my affiliate program, but i dont have one. can you help me create one?', 'role': 'user'}, {'content': "Absolutely! Creating an affiliate program for your Eli5 learning website can be a great way to expand your reach and monetize your audience. Here's a step-by-step guide on how to set up an affiliate program using proven platforms and best practices for a learning website like yours. I'll outline the roles of both an affiliate marketing expert and a web developer in this process.\n\n1. Choose an Affiliate Marketing Platform:\nAs an affiliate marketing expert, I recommend using established affiliate marketing software to manage your program efficiently. Some popular options include ShareASale, Rakuten Marketing (LinkShare), and Refersion. These platforms offer features like tracking, reporting, payment processing, and easy integration with your website.\n\n2. Set Up Your Affiliate Program:\n- Define the commission structure: Decide on a percentage or flat-rate commission for each sale or subscription made through an affiliate's unique referral link.\n- Choose payment terms: Determine how often you'll pay commissions (monthly, bi-monthly, etc.) and what payment methods you'll offer (PayPal, direct deposit, etc.).\n- Set up commission tiers or bonuses: Consider offering higher commissions for top-performing affiliates or incentives for referring a certain number of new sign-ups.\n\n3. Create Affiliate Registration and Dashboard:\nAs a web developer, you'll be responsible for integrating the affiliate platform into your website and creating a user-friendly registration and dashboard experience for affiliates. Most affiliate marketing platforms provide documentation and integration guides, so follow those to get started.\n\n4. Set Up Affiliate Tracking:\nEnsure proper tracking is in place to attribute sales and commissions to the correct affiliates. This may include implementing cookies, pixels, or other tracking technologies provided by your affiliate platform.\n\n5. Set Up Marketing Materials:\nCreate banners, text links, and other promotional materials for your affiliates to use on their websites or social media channels. Make sure these materials are visually appealing and clearly communicate the value proposition of your learning platform.\n\n6. Recruit Affiliates:\nReach out to potential affiliates in your niche, such as influencers, bloggers, educators, and content creators. Offer them a commission structure that incentivizes them to promote your platform to their audience.\n\n7. Provide Training and Support:\nOffer comprehensive training and resources to help your affiliates effectively promote your learning platform. This may include tutorials, promotional materials, and access to a dedicated support team.\n\n8. Monitor and Manage Your Affiliate Program:\nRegularly review your affiliate program's performance, identify top-performing affiliates, and address any issues or concerns that arise. Use the data provided by your affiliate platform to optimize your commission structure, marketing materials, and recruitment efforts.\n\nBy following these steps and collaborating closely with your web developer, you'll be able to create a successful affiliate program for your Eli5 learning website. This will not only help expand your reach and monetize your audience but also provide an additional revenue stream and valuable partnerships within your niche.", 'role': 'assistant'}]
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
Traceback (most recent call last):
  File "/home/wxt/huatong/TRL_FT/train_code/dpo_find_bug.py", line 55, in <module>
    generated_ids = model.generate(model_inputs, sampling_params)
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/entrypoints/llm.py", line 202, in generate
    self._add_request(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/entrypoints/llm.py", line 225, in _add_request
    self.llm_engine.add_request(request_id,
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/engine/llm_engine.py", line 395, in add_request
    prompt_token_ids = self.encode_request(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/engine/llm_engine.py", line 327, in encode_request
    prompt_token_ids = self.tokenizer.encode(request_id=request_id,
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/vllm/transformers_utils/tokenizer_group/tokenizer_group.py", line 42, in encode
    return tokenizer.encode(prompt)
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2630, in encode
    encoded_inputs = self.encode_plus(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3038, in encode_plus
    return self._encode_plus(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_fast.py", line 576, in _encode_plus
    batched_output = self._batch_encode_plus(
  File "/home/wxt/.conda/envs/rl/lib/python3.10/site-packages/transformers/tokenization_utils_fast.py", line 504, in _batch_encode_plus
    encodings = self._tokenizer.encode_batch(
TypeError: TextEncodeInput must be Union[TextInputSequence, Tuple[InputSequence, InputSequence]]
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Tokenizer Loading Finished!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.49it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.53it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.36it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.40it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.84it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.74it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.88it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.85it/s]
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
Model Loading Finished!
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
==================================================
base-model <s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] Certainly! Here's a simple recipe for homemade mayonnaise that you might enjoy.

Ingredients:
- 1 egg yolk
- 1 tbsp dijon mustard
- 1 tbsp white wine vinegar or lemon juice
- 1 cup oil (vegetable or canola)
- Salt to taste

Instructions:
1. In a medium-sized bowl, whisk together the egg yolk, mustard, and vinegar or lemon juice until it thickens slightly and turns a pale yellow color.
2. Drizzle in the oil very slowly, one drop at a time, while constantly whisking to emulsify it into the mixture. It's important to do this slowly to ensure that the mayonnaise turns out thick and creamy.
3. Once about half the oil has been incorporated, you can start adding it in a thin, steady stream.
4. If the mayonnaise thickens up before you've added all the oil, just whisk in a few drops of water until it reaches the desired consistency.
5. Taste the mayonnaise and add salt to taste.

Store your homemade mayonnaise in an airtight container in the refrigerator, and it should keep for up to a week. Enjoy!</s>
==================================================
new-model <s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] Absolutely! Here's a simple yet delicious homemade mayonnaise recipe for you:

Ingredients:
- 1 egg yolk (at room temperature)
- 1 tablespoon Dijon mustard
- 1 cup (14 oz / 400ml) vegetable oil
- 1-2 tablespoons fresh lemon juice
- 1-2 teaspoons white wine vinegar or apple cider vinegar
- Salt to taste

Instructions:
1. In a large bowl, whisk together the egg yolk and mustard until they are thoroughly combined and pale in color.
2. Very slowly and gradually, begin to drizzle in the vegetable oil, while constantly whisking to emulsify it. Be patient and make sure each drop of oil is fully incorporated before adding the next one.
3. Once about half of the oil has been added and the mayonnaise has thickened, you can begin to stream in the oil more quickly.
4. Once all of the oil has been incorporated, whisk in the lemon juice, vinegar, and a pinch of salt. Taste the mayonnaise and add more salt, lemon juice, or vinegar if desired.
5. Cover the bowl with plastic wrap, pressing it directly onto the surface of the mayonnaise to prevent a skin from forming. Refrigerate for at least 1 hour before serving to let the flavors meld together.

Enjoy your homemade mayonnaise! It will keep in an airtight container in the refrigerator for up to 1 week.</s>
==================================================
Tokenizer Loading Finished!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.18it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.38it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.58it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.50it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  2.32it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  2.38it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.48it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.45it/s]
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
Model Loading Finished!
enceodeds: tensor([[    1,   733, 16289, 28793,  1824,   349,   574, 16020,  2076,  2487,
         28804,   733, 28748, 16289, 28793,  6824, 28725,   315, 28742, 28719,
          3448, 10473,   298,   264,  1179, 11322, 19961,   302,  6138, 23598,
         18342, 28723,   661, 13633,   776,   272,  1103,  3558,   302,   686,
         16944, 15637,   423,   298,  5681,   315, 28742, 28719, 13198,   582,
           297,   272,  6132, 28808,     2,   733, 16289, 28793,  2378,   368,
           506,   993,  7136,   864, 21116, 28804,   733, 28748, 16289, 28793]])
enceodeds_2: <s>[INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s>[INST] Do you have mayonnaise recipes? [/INST]
Base-model Output:
base-model-0:<s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] I'm an artificial intelligence and don't have the ability to cook or create recipes myself, but I can certainly help you find a mayonnaise recipe if you'd like! Here's a classic one using just a few simple ingredients:

**Homemade Mayonnaise**

Ingredients:
- 1 egg yolk
- 1 tablespoon Dijon mustard
- 1 cup vegetable oil
- 1 tablespoon white wine vinegar or lemon juice
- Salt, to taste

Instructions:
1. In a medium bowl, whisk together the egg yolk and Dijon mustard until combined.
2. Slowly drizzle in the vegetable oil drop by drop while continuously whisking, until the mixture has thickened and emulsified.
3. Once the oil has been fully incorporated, whisk in the vinegar or lemon juice.
4. Season with salt to taste.
5. If the mayonnaise is too thick, thin it out with a small amount of cold water.

Enjoy your homemade mayonnaise! It's delicious on sandwiches, as a dip, or as a base for many sauces.</s>
==================================================
Base-model Output:
base-model-1:<s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] I may not have the ability to cook or create physical condiments like mayonnaise, but I can certainly suggest a simple and classic homemade mayonnaise recipe for you. Here's a quick one:

Ingredients:
- 1 egg yolk
- 1 tablespoon dijon mustard
- 1 cup oil (canola, vegetable, or light olive oil)
- 1 tablespoon white wine vinegar or lemon juice
- 1/2 teaspoon salt
- Pinch of black pepper

Instructions:
1. In a medium sized, deep bowl, whisk together the egg yolk and mustard until they are well combined.
2. Start adding the oil, very slowly at first, drop by drop, while continuously whisking the mixture. Once the oil is fully incorporated, you can start to add it in a thin, steady stream. Be sure not to add the oil too quickly or the mayonnaise may break or separate.
3. Once you've added about 1/4 to 1/3 of the oil, add the vinegar or lemon juice and a pinch of salt. Continue whisking while adding the rest of the oil in a thin, steady stream.
4. Once all the oil is incorporated and the mixture is thick and smooth, whisk in the remaining salt and pepper.

Taste your homemade mayonnaise and adjust the seasoning if necessary. If it becomes too thick, you can thin it out with a bit of water or milk. Enjoy your freshly made mayonnaise!

This recipe allows you to customize the texture and taste by using different oils, vinegars, and spices, but please remember that consuming undercooked or raw eggs poses a risk of foodborne illness. Always use the freshest eggs and take necessary precautions when making homemade mayonnaise or other dishes that involve raw eggs.</s>
==================================================
Base-model Output:
base-model-2:<s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] Absolutely! Here's a simple and classic Homemade Mayonnaise recipe for you:

Ingredients:
- 1 egg yolk
- 1 teaspoon Dijon mustard
- 1 tablespoon white wine vinegar or apple cider vinegar
- 1 cup vegetable oil (canola, soybean, or avocado oil ideal)
- Salt to taste (optional)

Instructions:
1. In a medium-sized bowl, whisk together the egg yolk, mustard, and vinegar until they're well combined.
2. Start drizzling the oil slowly into the egg mixture, constantly whisking it as you go. Begin with a few drops and gradually add more, making sure each addition is fully incorporated before adding the next one. This process might take 5-10 minutes in total.
3. As the mixture starts to thicken, you can gradually increase the amount of oil you add in a thin stream.
4. Once all the oil has been added, and the mayonnaise is thick and creamy, taste it and add a pinch of salt if desired.
5. Cover the bowl with a tight-fitting lid or cling wrap and refrigerate it right away. Store it in the fridge for up to one week.

Note: Be very cautious when making homemade mayonnaise as undercooked or raw eggs carry a risk of Salmonella infection. If you're concerned, you may opt for using pre-packaged pasteurized egg yolks or substitute pasteurized mayonnaise.</s>
==================================================
New-model Output:
new-model-0:<s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] Indeed! Here's a simple and classicmayonnaise recipe for you. I call it "Fancy Mayo" because it's a bit fancier than the store-bought kind.

Ingredients:
- 1 egg yolk (at room temperature)
- 1 teaspoon dijon mustard
- 1 teaspoon white wine vinegar
- 1 cup vegetable oil
- Salt, to taste
- 1-2 tablespoons water (if needed)

Instructions:
1. In a large bowl, whisk together the egg yolk, mustard, and vinegar until they are well combined and the mixture has lightened in color.
2. Drop by drop, very slowly, start adding the oil to the egg yolk mixture, whisking constantly. Begin with a few drops to make sure the oil is being absorbed before adding it in a steady stream.
3. Once the oil is being absorbed easily, you can gradually increase the stream to a thin, steady drizzle. Continue whisking constantly until all of the oil has been added.
4. Taste the mayonnaise and add salt, to taste. If the mayonnaise is too thick, add water, one tablespoon at a time, until it reaches your desired consistency.
5. Refrigerate the mayonnaise in an airtight container for up to one week.

Enjoy your homemade "Fancy Mayo"! It's perfect for sandwiches, burgers, or as a dip for vegetables.</s>
==================================================
New-model Output:
new-model-1:<s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] Absolutely! Here's a simple and classic Homemade Mayonnaise recipe for you:

Ingredients:
- 1 egg yolk (at room temperature)
- 1 tablespoon of Dijon mustard
- 1 cup of vegetable oil (canola or sunflower oil work best)
- 1-2 tablespoons of white wine vinegar or fresh lemon juice
- Salt, to taste

Instructions:
1. In a large bowl, whisk together the egg yolk and mustard. Make sure the yolk is at room temperature for best results.

2. Drizzle in the oil very slowly, drop by drop, while continuously whisking. This is important to prevent the oil from separating from the yolk mixture.

3. Once all the oil has been incorporated and the mayonnaise has thickened, whisk in the vinegar or lemon juice.

4. Season with salt to taste.

5. Store the homemade mayonnaise in an airtight container in the refrigerator for up to a week. Be sure to mix well before using.

Enjoy your freshly made mayonnaise as a sandwich spread, dipping sauce, or a base for other sauces and dressings!</s>
==================================================
New-model Output:
new-model-2:<s> [INST] What is your favourite condiment? [/INST]Well, I'm quite partial to a good squeeze of fresh lemon juice. It adds just the right amount of zesty flavour to whatever I'm cooking up in the kitchen!</s> [INST] Do you have mayonnaise recipes? [/INST] Absolutely! Here's a simple and classic Homemade Mayonnaise recipe. You'll need:

- 1 egg yolk
- 1 tablespoon of Dijon mustard
- 1 cup of vegetable oil (such as canola or safflower)
- 1-2 tablespoons of white wine vinegar or fresh lemon juice
- Salt, to taste

Instructions:

1. In a medium-sized mixing bowl, whisk together the egg yolk and mustard until they are well combined. Make sure your bowl is large enough to accommodate the oil being added slowly.
2. Start adding the oil very gradually (a few drops at a time) while continuously whisking the egg yolk mixture. The key here is to whisk constantly to ensure the oil is being emulsified evenly and that the mayonnaise doesn't separate.
3. Once the oil has been incorporated, you can begin adding the vinegar or lemon juice in a thin stream while continuing to whisk steadily. Add the acid gradually to prevent the mayonnaise from curdling, and taste as you go to determine how much you prefer.
4. Season the mayonnaise with salt to taste.
5. Transfer the homemade mayonnaise to an airtight container and refrigerate for up to 1 week.

Optional add-ins: For flavoured mayonnaises, you can stir in herbs, finely chopped vegetables, or spices after making the basic mayonnaise. Some popular variations include herb mayonnaise (parmesan, chive, etc.), curry mayonnaise, garlic mayonnaise, or smoked paprika mayonnaise.</s>
==================================================
