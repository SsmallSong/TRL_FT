4
4
4
4
/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/wxt/.conda/envs/halos3/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.88s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:05<00:05,  5.28s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.16s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.03s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.36s/it]
Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.94s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.39s/it]
loaded pre-trained weights
<class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
LlamaConfig {
  "_name_or_path": "daryl149/llama-2-7b-hf",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "max_position_embeddings": 2048,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float16",
  "transformers_version": "4.35.2",
  "use_cache": true,
  "vocab_size": 32000
}

Rank 0 is activated...
loaded pre-trained weights
Rank 2 is activated...
loaded pre-trained weights
Rank 3 is activated...
loaded pre-trained weights
Rank 1 is activated...
  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:20<06:44, 20.24s/it]  5%|▍         | 1/21 [00:20<06:59, 20.96s/it]  5%|▍         | 1/21 [00:21<07:01, 21.08s/it]  5%|▍         | 1/21 [00:21<07:05, 21.26s/it] 10%|▉         | 2/21 [00:36<05:44, 18.15s/it] 10%|▉         | 2/21 [00:37<05:50, 18.44s/it] 10%|▉         | 2/21 [00:37<05:51, 18.50s/it] 10%|▉         | 2/21 [00:37<05:53, 18.59s/it] 14%|█▍        | 3/21 [00:53<05:15, 17.54s/it] 14%|█▍        | 3/21 [00:54<05:18, 17.67s/it] 14%|█▍        | 3/21 [00:54<05:18, 17.72s/it] 14%|█▍        | 3/21 [00:54<05:20, 17.78s/it] 19%|█▉        | 4/21 [01:10<04:53, 17.29s/it] 19%|█▉        | 4/21 [01:11<04:54, 17.34s/it] 19%|█▉        | 4/21 [01:11<04:55, 17.39s/it] 19%|█▉        | 4/21 [01:11<04:56, 17.43s/it] 24%|██▍       | 5/21 [01:27<04:35, 17.19s/it] 24%|██▍       | 5/21 [01:28<04:34, 17.18s/it] 24%|██▍       | 5/21 [01:28<04:35, 17.23s/it] 24%|██▍       | 5/21 [01:28<04:36, 17.26s/it] 29%|██▊       | 6/21 [01:44<04:17, 17.15s/it] 29%|██▊       | 6/21 [01:45<04:16, 17.10s/it] 29%|██▊       | 6/21 [01:45<04:17, 17.15s/it] 29%|██▊       | 6/21 [01:45<04:17, 17.18s/it] 33%|███▎      | 7/21 [02:01<04:00, 17.15s/it] 33%|███▎      | 7/21 [02:02<03:58, 17.06s/it] 33%|███▎      | 7/21 [02:02<03:59, 17.12s/it] 33%|███▎      | 7/21 [02:02<03:59, 17.14s/it] 38%|███▊      | 8/21 [02:19<03:43, 17.16s/it] 38%|███▊      | 8/21 [02:19<03:41, 17.05s/it] 38%|███▊      | 8/21 [02:19<03:42, 17.12s/it] 38%|███▊      | 8/21 [02:19<03:42, 17.13s/it] 43%|████▎     | 9/21 [02:36<03:24, 17.04s/it] 43%|████▎     | 9/21 [02:36<03:26, 17.17s/it] 43%|████▎     | 9/21 [02:36<03:25, 17.12s/it] 43%|████▎     | 9/21 [02:36<03:25, 17.12s/it] 48%|████▊     | 10/21 [02:53<03:07, 17.04s/it] 48%|████▊     | 10/21 [02:53<03:08, 17.18s/it] 48%|████▊     | 10/21 [02:53<03:08, 17.12s/it] 48%|████▊     | 10/21 [02:54<03:08, 17.12s/it] 52%|█████▏    | 11/21 [03:10<02:50, 17.05s/it] 52%|█████▏    | 11/21 [03:10<02:51, 17.19s/it] 52%|█████▏    | 11/21 [03:10<02:51, 17.12s/it] 52%|█████▏    | 11/21 [03:11<02:51, 17.12s/it] 57%|█████▋    | 12/21 [03:25<02:28, 16.54s/it] 57%|█████▋    | 12/21 [03:27<02:34, 17.19s/it] 57%|█████▋    | 12/21 [03:28<02:34, 17.12s/it] 57%|█████▋    | 12/21 [03:28<02:34, 17.12s/it] 62%|██████▏   | 13/21 [03:42<02:13, 16.70s/it] 62%|██████▏   | 13/21 [03:45<02:17, 17.19s/it] 62%|██████▏   | 13/21 [03:45<02:16, 17.12s/it] 62%|██████▏   | 13/21 [03:45<02:16, 17.12s/it] 67%|██████▋   | 14/21 [03:59<01:57, 16.80s/it] 67%|██████▋   | 14/21 [04:02<02:00, 17.19s/it] 67%|██████▋   | 14/21 [04:02<01:59, 17.12s/it] 67%|██████▋   | 14/21 [04:02<01:59, 17.12s/it] 71%|███████▏  | 15/21 [04:16<01:41, 16.87s/it] 71%|███████▏  | 15/21 [04:19<01:43, 17.18s/it] 71%|███████▏  | 15/21 [04:19<01:42, 17.12s/it] 71%|███████▏  | 15/21 [04:19<01:42, 17.11s/it] 76%|███████▌  | 16/21 [04:33<01:24, 16.91s/it] 76%|███████▌  | 16/21 [04:36<01:25, 17.18s/it] 76%|███████▌  | 16/21 [04:36<01:25, 17.11s/it] 76%|███████▌  | 16/21 [04:36<01:25, 17.11s/it] 81%|████████  | 17/21 [04:50<01:07, 16.95s/it] 81%|████████  | 17/21 [04:53<01:08, 17.17s/it] 81%|████████  | 17/21 [04:53<01:08, 17.11s/it] 81%|████████  | 17/21 [04:53<01:08, 17.10s/it] 86%|████████▌ | 18/21 [05:07<00:50, 16.97s/it] 86%|████████▌ | 18/21 [05:10<00:51, 17.11s/it] 86%|████████▌ | 18/21 [05:10<00:51, 17.16s/it] 86%|████████▌ | 18/21 [05:10<00:51, 17.10s/it] 90%|█████████ | 19/21 [05:24<00:33, 16.98s/it] 90%|█████████ | 19/21 [05:27<00:34, 17.10s/it] 90%|█████████ | 19/21 [05:27<00:34, 17.15s/it] 90%|█████████ | 19/21 [05:27<00:34, 17.09s/it] 95%|█████████▌| 20/21 [05:41<00:16, 16.99s/it] 95%|█████████▌| 20/21 [05:44<00:17, 17.09s/it] 95%|█████████▌| 20/21 [05:45<00:17, 17.15s/it] 95%|█████████▌| 20/21 [05:45<00:17, 17.09s/it]100%|██████████| 21/21 [05:54<00:00, 15.72s/it]100%|██████████| 21/21 [05:54<00:00, 16.88s/it]
100%|██████████| 21/21 [05:57<00:00, 15.80s/it]100%|██████████| 21/21 [05:57<00:00, 17.03s/it]
100%|██████████| 21/21 [05:57<00:00, 15.79s/it]100%|██████████| 21/21 [05:57<00:00, 17.04s/it]
100%|██████████| 21/21 [05:57<00:00, 15.85s/it]100%|██████████| 21/21 [05:57<00:00, 17.05s/it]




Eval on harmless_base.json
  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:20<06:59, 20.99s/it]  5%|▍         | 1/22 [00:21<07:25, 21.22s/it]  5%|▍         | 1/22 [00:21<07:25, 21.23s/it]  5%|▍         | 1/21 [00:21<07:11, 21.57s/it] 10%|▉         | 2/21 [00:37<05:53, 18.63s/it]  9%|▉         | 2/22 [00:38<06:15, 18.76s/it]  9%|▉         | 2/22 [00:38<06:16, 18.84s/it] 10%|▉         | 2/21 [00:38<05:59, 18.93s/it] 14%|█▍        | 3/21 [00:54<05:22, 17.89s/it] 14%|█▎        | 3/22 [00:55<05:42, 18.01s/it] 14%|█▎        | 3/22 [00:55<05:43, 18.08s/it] 14%|█▍        | 3/21 [00:55<05:25, 18.10s/it] 19%|█▉        | 4/21 [01:12<04:58, 17.56s/it] 18%|█▊        | 4/22 [01:12<05:17, 17.66s/it] 18%|█▊        | 4/22 [01:12<05:19, 17.74s/it] 19%|█▉        | 4/21 [01:12<05:01, 17.72s/it] 24%|██▍       | 5/21 [01:29<04:37, 17.37s/it] 23%|██▎       | 5/22 [01:29<04:57, 17.48s/it] 23%|██▎       | 5/22 [01:30<04:58, 17.55s/it] 24%|██▍       | 5/21 [01:30<04:40, 17.51s/it] 29%|██▊       | 6/21 [01:46<04:18, 17.26s/it] 27%|██▋       | 6/22 [01:46<04:37, 17.36s/it] 27%|██▋       | 6/22 [01:47<04:38, 17.42s/it] 29%|██▊       | 6/21 [01:47<04:20, 17.37s/it] 33%|███▎      | 7/21 [02:03<04:00, 17.18s/it] 32%|███▏      | 7/22 [02:03<04:19, 17.28s/it] 32%|███▏      | 7/22 [02:04<04:20, 17.34s/it] 33%|███▎      | 7/21 [02:04<04:02, 17.29s/it] 38%|███▊      | 8/21 [02:20<03:42, 17.13s/it] 36%|███▋      | 8/22 [02:21<04:01, 17.23s/it] 36%|███▋      | 8/22 [02:21<04:02, 17.30s/it] 38%|███▊      | 8/21 [02:21<03:44, 17.24s/it] 43%|████▎     | 9/21 [02:37<03:25, 17.11s/it] 41%|████      | 9/22 [02:38<03:43, 17.20s/it] 43%|████▎     | 9/21 [02:38<03:26, 17.21s/it] 41%|████      | 9/22 [02:38<03:44, 17.27s/it] 48%|████▊     | 10/21 [02:54<03:07, 17.08s/it] 45%|████▌     | 10/22 [02:55<03:26, 17.17s/it] 48%|████▊     | 10/21 [02:55<03:08, 17.18s/it] 45%|████▌     | 10/22 [02:55<03:26, 17.23s/it] 52%|█████▏    | 11/21 [03:11<02:50, 17.06s/it] 50%|█████     | 11/22 [03:12<03:08, 17.15s/it] 52%|█████▏    | 11/21 [03:12<02:51, 17.16s/it] 50%|█████     | 11/22 [03:13<03:09, 17.21s/it] 57%|█████▋    | 12/21 [03:28<02:33, 17.04s/it] 55%|█████▍    | 12/22 [03:29<02:51, 17.13s/it] 57%|█████▋    | 12/21 [03:29<02:34, 17.13s/it] 55%|█████▍    | 12/22 [03:30<02:51, 17.19s/it] 62%|██████▏   | 13/21 [03:45<02:16, 17.03s/it] 59%|█████▉    | 13/22 [03:46<02:34, 17.11s/it] 62%|██████▏   | 13/21 [03:46<02:16, 17.12s/it] 59%|█████▉    | 13/22 [03:47<02:34, 17.17s/it] 67%|██████▋   | 14/21 [04:02<01:59, 17.02s/it] 64%|██████▎   | 14/22 [04:03<02:16, 17.10s/it] 67%|██████▋   | 14/21 [04:03<01:59, 17.10s/it] 64%|██████▎   | 14/22 [04:04<02:17, 17.15s/it] 71%|███████▏  | 15/21 [04:19<01:42, 17.01s/it] 68%|██████▊   | 15/22 [04:20<01:59, 17.09s/it] 71%|███████▏  | 15/21 [04:21<01:42, 17.09s/it] 68%|██████▊   | 15/22 [04:21<02:00, 17.14s/it] 76%|███████▌  | 16/21 [04:36<01:25, 17.01s/it] 73%|███████▎  | 16/22 [04:37<01:42, 17.09s/it] 76%|███████▌  | 16/21 [04:38<01:25, 17.08s/it] 73%|███████▎  | 16/22 [04:38<01:42, 17.13s/it] 81%|████████  | 17/21 [04:53<01:07, 17.00s/it] 77%|███████▋  | 17/22 [04:54<01:25, 17.08s/it] 81%|████████  | 17/21 [04:55<01:08, 17.08s/it] 77%|███████▋  | 17/22 [04:55<01:25, 17.13s/it] 86%|████████▌ | 18/21 [05:10<00:50, 16.99s/it] 82%|████████▏ | 18/22 [05:11<01:08, 17.08s/it] 86%|████████▌ | 18/21 [05:12<00:51, 17.07s/it] 82%|████████▏ | 18/22 [05:12<01:08, 17.12s/it]
