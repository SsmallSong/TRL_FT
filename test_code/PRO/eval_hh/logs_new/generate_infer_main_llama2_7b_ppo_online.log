4
4
4
4
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.97s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.87s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.88s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.94s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:01,  1.68s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:01,  1.62s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:01,  1.63s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:01,  1.67s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.42s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.52s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.37s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.47s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.37s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.47s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.41s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.51s/it]
<class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
LlamaConfig {
  "_name_or_path": "/home/wxt/.cache/huggingface/hub/llama2_ppo_online",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "max_position_embeddings": 2048,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.41.2",
  "use_cache": true,
  "vocab_size": 32000
}

Rank 0 is activated...
Rank 1 is activated...
Rank 3 is activated...
Rank 2 is activated...
  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  5%|▍         | 1/21 [00:21<07:09, 21.47s/it]  5%|▍         | 1/21 [00:21<07:16, 21.81s/it]  5%|▍         | 1/21 [00:22<07:26, 22.33s/it]  5%|▍         | 1/21 [00:22<07:26, 22.30s/it] 10%|▉         | 2/21 [00:39<06:09, 19.47s/it] 10%|▉         | 2/21 [00:39<06:13, 19.65s/it] 10%|▉         | 2/21 [00:40<06:16, 19.81s/it] 10%|▉         | 2/21 [00:40<06:16, 19.83s/it] 14%|█▍        | 3/21 [00:57<05:39, 18.89s/it] 14%|█▍        | 3/21 [00:58<05:41, 18.99s/it] 14%|█▍        | 3/21 [00:58<05:42, 19.05s/it] 14%|█▍        | 3/21 [00:58<05:43, 19.06s/it] 19%|█▉        | 4/21 [01:16<05:16, 18.64s/it] 19%|█▉        | 4/21 [01:16<05:17, 18.70s/it] 19%|█▉        | 4/21 [01:16<05:18, 18.71s/it] 19%|█▉        | 4/21 [01:16<05:18, 18.72s/it] 24%|██▍       | 5/21 [01:34<04:56, 18.54s/it] 24%|██▍       | 5/21 [01:34<04:57, 18.57s/it] 24%|██▍       | 5/21 [01:34<04:56, 18.55s/it] 24%|██▍       | 5/21 [01:35<04:57, 18.57s/it] 29%|██▊       | 6/21 [01:52<04:37, 18.49s/it] 29%|██▊       | 6/21 [01:53<04:37, 18.50s/it] 29%|██▊       | 6/21 [01:53<04:37, 18.47s/it] 29%|██▊       | 6/21 [01:53<04:37, 18.50s/it] 33%|███▎      | 7/21 [02:11<04:18, 18.50s/it] 33%|███▎      | 7/21 [02:11<04:18, 18.48s/it] 33%|███▎      | 7/21 [02:11<04:17, 18.42s/it] 33%|███▎      | 7/21 [02:11<04:18, 18.47s/it] 38%|███▊      | 8/21 [02:29<04:00, 18.51s/it] 38%|███▊      | 8/21 [02:30<04:00, 18.49s/it] 38%|███▊      | 8/21 [02:30<03:59, 18.42s/it] 38%|███▊      | 8/21 [02:30<03:59, 18.45s/it] 43%|████▎     | 9/21 [02:48<03:42, 18.52s/it] 43%|████▎     | 9/21 [02:48<03:40, 18.39s/it] 43%|████▎     | 9/21 [02:48<03:41, 18.49s/it] 43%|████▎     | 9/21 [02:48<03:41, 18.44s/it] 48%|████▊     | 10/21 [03:06<03:22, 18.40s/it] 48%|████▊     | 10/21 [03:06<03:23, 18.53s/it] 48%|████▊     | 10/21 [03:07<03:23, 18.50s/it] 48%|████▊     | 10/21 [03:07<03:22, 18.43s/it] 52%|█████▏    | 11/21 [03:25<03:04, 18.42s/it] 52%|█████▏    | 11/21 [03:25<03:05, 18.53s/it] 52%|█████▏    | 11/21 [03:25<03:04, 18.49s/it] 52%|█████▏    | 11/21 [03:25<03:04, 18.43s/it] 57%|█████▋    | 12/21 [03:43<02:45, 18.41s/it] 57%|█████▋    | 12/21 [03:44<02:46, 18.55s/it] 57%|█████▋    | 12/21 [03:43<02:45, 18.44s/it] 57%|█████▋    | 12/21 [03:44<02:46, 18.49s/it] 62%|██████▏   | 13/21 [04:02<02:27, 18.42s/it] 62%|██████▏   | 13/21 [04:02<02:27, 18.45s/it] 62%|██████▏   | 13/21 [04:02<02:28, 18.55s/it] 62%|██████▏   | 13/21 [04:02<02:28, 18.50s/it] 67%|██████▋   | 14/21 [04:20<02:08, 18.41s/it] 67%|██████▋   | 14/21 [04:20<02:09, 18.46s/it] 67%|██████▋   | 14/21 [04:21<02:09, 18.54s/it] 67%|██████▋   | 14/21 [04:21<02:09, 18.51s/it] 71%|███████▏  | 15/21 [04:38<01:50, 18.40s/it] 71%|███████▏  | 15/21 [04:39<01:50, 18.47s/it] 71%|███████▏  | 15/21 [04:39<01:51, 18.53s/it] 71%|███████▏  | 15/21 [04:39<01:50, 18.50s/it] 76%|███████▌  | 16/21 [04:57<01:32, 18.40s/it] 76%|███████▌  | 16/21 [04:57<01:32, 18.47s/it] 76%|███████▌  | 16/21 [04:58<01:32, 18.50s/it] 76%|███████▌  | 16/21 [04:58<01:32, 18.54s/it] 81%|████████  | 17/21 [05:15<01:13, 18.40s/it] 81%|████████  | 17/21 [05:16<01:13, 18.46s/it] 81%|████████  | 17/21 [05:16<01:13, 18.49s/it] 81%|████████  | 17/21 [05:16<01:14, 18.52s/it] 86%|████████▌ | 18/21 [05:33<00:55, 18.38s/it] 86%|████████▌ | 18/21 [05:34<00:55, 18.44s/it] 86%|████████▌ | 18/21 [05:34<00:55, 18.47s/it] 86%|████████▌ | 18/21 [05:35<00:55, 18.51s/it] 90%|█████████ | 19/21 [05:52<00:36, 18.36s/it] 90%|█████████ | 19/21 [05:53<00:36, 18.41s/it] 90%|█████████ | 19/21 [05:53<00:36, 18.44s/it] 90%|█████████ | 19/21 [05:53<00:36, 18.47s/it] 95%|█████████▌| 20/21 [06:10<00:18, 18.35s/it] 95%|█████████▌| 20/21 [06:11<00:18, 18.38s/it] 95%|█████████▌| 20/21 [06:11<00:18, 18.43s/it] 95%|█████████▌| 20/21 [06:11<00:18, 18.46s/it]100%|██████████| 21/21 [06:24<00:00, 16.93s/it]100%|██████████| 21/21 [06:24<00:00, 18.30s/it]
100%|██████████| 21/21 [06:24<00:00, 16.96s/it]100%|██████████| 21/21 [06:24<00:00, 18.33s/it]
100%|██████████| 21/21 [06:25<00:00, 17.00s/it]100%|██████████| 21/21 [06:25<00:00, 18.35s/it]
100%|██████████| 21/21 [06:25<00:00, 17.03s/it]100%|██████████| 21/21 [06:25<00:00, 18.36s/it]




Eval on harmless_base.json
